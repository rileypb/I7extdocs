<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Extension</title><script type="text/javascript">	function showExtra(id, imid) {		if (document.getElementById(id).style.display == 'block') {			document.getElementById(id).style.display = 'none';			document.getElementById(imid).src = 'inform:/extra.png';		} else {			document.getElementById(id).style.display = 'block';			document.getElementById(imid).src = 'inform:/extraclose.png';		}	}    function openExtra(id, imid) {    	document.getElementById(id).style.display = 'block';    	document.getElementById(imid).src = 'inform:/extraclose.png';    }    function closeExtra(id, imid) {    	document.getElementById(id).style.display = 'none';    	document.getElementById(imid).src = 'inform:/extra.png';    }</script></head><STYLE TYPE="text/css"><!--*, *:before, *:after {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.oval, .oval TD{background-image:url('../../doc_images/ovoid.png');color:white;}--></STYLE><body><script language="JavaScript">function pasteCode(code) {    var myProject = window.Project;    myProject.selectView('source');    myProject.pasteCode(code);}</script><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><table CELLPADDING=0 CELLSPACING=0 width="100%" bgcolor="#000000"><tr><TD width=38px height=26px align="center" valign="center"></td><TD width=38px height=26px align="center" valign="center"></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0></td><TD width=56px height=26px align="right" valign="center"></td></tr></table><p><img border=0 src=../../doc_images/paste.png>&nbsp;<b>JSON<font color="#404040"> by </font>Dannii Willis</b><p><small></small><p><p><hr><p>
<p>
 This extension provides support for parsing, processing, and generating JSON.
<p>
 Chapter - Creating JSON references
<p>
 The basic data structure in this extension is the JSON reference. You can create JSON references with these phrases:
<p>
<blockquote><font color="#000080"> JSON null<br> JSON true<br> JSON false/boolean<br> JSON number (N - number)<br> JSON real number (N - real number)<br> JSON string/text from (T - text)<br> JSON array<br> JSON object</font></blockquote>
<p>
 To determine which type a JSON reference has, use the phrase &quot;type of (json reference)&quot;.
<p>
 Chapter - Reading and setting JSON references
<p>
 You can access the internal data of a JSON reference with these phrases. If you try to access a reference using the wrong type an error will be shown.
<p>
<blockquote><font color="#000080"> if (R - JSON reference) as a truth state:<br> (R - JSON reference) as a number<br> (R - JSON reference) as a real number<br> let (T - nonexisting text variable) be (R - JSON reference) as a text/string<br> let (L - nonexisting list of JSON references variable) be (R - JSON reference) as a/an list/array</font></blockquote>
<p>
 To set a boolean, number, or real number, use these phrases:
<p>
<blockquote><font color="#000080"> set (R - JSON reference) to (V - truth state)<br> set (R - JSON reference) to (V - number)<br> set (R - JSON reference) to (V - real number)</font></blockquote>
<p>
 Strings and arrays can be modified in place using the standard Inform phrases. You do not need to update the JSON reference with the new text or list.
<p>
 Chapter - JSON objects
<p>
 There is no Inform data structure that fits a JSON object, but you can use these phrases to access them:
<p>
<blockquote><font color="#000080"> if (R - JSON reference) has key (K - text):<br> set key (K - text) of (R - JSON reference) to (V - JSON reference)<br> get key (K - text) of (R - JSON reference)<br> delete key (K - text) of (R - JSON reference)</font></blockquote>
<p>
 You can also repeat through the keys of a JSON object with this phrase:
<p>
<blockquote><font color="#000080"> repeat with (loopvar - nonexisting text variable) of/in (R - JSON reference)</font></blockquote>
<p>
 Chapter - Parsing and stringifying JSON
<p>
 These two phrases will parse a text into a JSON reference, and a JSON reference into a text:
<p>
<blockquote><font color="#000080"> parse (T - a text)<br> say (R - JSON reference)<br> say (R - JSON reference) escaping non-ASCII</font></blockquote>
<p>
 You can use the standard Inform phrases &quot;text of (external file)&quot; and &quot;write (text) to (external file)&quot; to read and write JSON files, but note that they will have the. glkdata extension, as well as the normal Inform file header. These file phrases only support ASCII, so use the &quot;escaping non-ASCII&quot; phrase if you have non-ASCII characters.
<p>
 Chapter - Cleaning up
<p>
 JSON references exist outside the normal Inform model, so you must manually destroy them in order to not leak memory. Destroying an array or object will clean up all of its contents as well.
<p>
<blockquote><font color="#000080"> destroy (R - JSON reference)</font></blockquote>
<p>
 Example: * Actions tracker
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> &quot;Actions tracker&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Include JSON by Dannii Willis.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Lab is a room.<br> In the lab is a coin.</font></blockquote>
<p>
<blockquote><font color="#000080"> The File of Tracked Actions is called &quot;actions&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; if the File of Tracked Actions exists:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let text data be &quot;[text of File of Tracked Actions]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let json data be parse text data;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if json data has key &quot;restarted&quot;:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You have restarted this demo.[line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You have not yet restarted this demo.[line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if json data has key &quot;jumped&quot;:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let jump count be get key &quot;jumped&quot; of json data;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You have jumped [jump count as a number] times.[line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if json data has key &quot;picked up coin&quot;:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let pick up coint count be get key &quot;picked up coin&quot; of json data;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You have picked up the coin [pick up coint count as a number] times.[line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destroy json data;</font></blockquote>
<p>
<blockquote><font color="#000080"> First carry out restarting the game rule:<br>&nbsp;&nbsp;&nbsp;&nbsp; let json data be a JSON reference;<br>&nbsp;&nbsp;&nbsp;&nbsp; if the File of Tracked Actions exists:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let text data be &quot;[text of File of Tracked Actions]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let json data be parse text data;<br>&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let json data be a new JSON object;<br>&nbsp;&nbsp;&nbsp;&nbsp; set key &quot;restarted&quot; of json data to JSON true;<br>&nbsp;&nbsp;&nbsp;&nbsp; write &quot;[json data]&quot; to File of Tracked Actions;<br>&nbsp;&nbsp;&nbsp;&nbsp; destroy json data;</font></blockquote>
<p>
<blockquote><font color="#000080"> To increment (T - a text) in tracked actions:<br>&nbsp;&nbsp;&nbsp;&nbsp; let json data be a JSON reference;<br>&nbsp;&nbsp;&nbsp;&nbsp; if the File of Tracked Actions exists:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let text data be &quot;[text of File of Tracked Actions]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let json data be parse text data;<br>&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let json data be a new JSON object;<br>&nbsp;&nbsp;&nbsp;&nbsp; let count be 0;<br>&nbsp;&nbsp;&nbsp;&nbsp; if json data has key T:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now count is get key T of json data as a number;<br>&nbsp;&nbsp;&nbsp;&nbsp; increment count;<br>&nbsp;&nbsp;&nbsp;&nbsp; set key T of json data to JSON number count;<br>&nbsp;&nbsp;&nbsp;&nbsp; write &quot;[json data]&quot; to File of Tracked Actions;<br>&nbsp;&nbsp;&nbsp;&nbsp; destroy json data;</font></blockquote>
<p>
<blockquote><font color="#000080"> Carry out jumping:<br>&nbsp;&nbsp;&nbsp;&nbsp; increment &quot;jumped&quot; in tracked actions;</font></blockquote>
<p>
<blockquote><font color="#000080"> After taking the coin:<br>&nbsp;&nbsp;&nbsp;&nbsp; increment &quot;picked up coin&quot; in tracked actions;<br>&nbsp;&nbsp;&nbsp;&nbsp; continue the action;</font></blockquote>
<p>

<p>
<p></body></html>