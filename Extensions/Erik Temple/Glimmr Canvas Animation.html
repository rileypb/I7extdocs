<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Extension</title><script type="text/javascript">	function showExtra(id, imid) {		if (document.getElementById(id).style.display == 'block') {			document.getElementById(id).style.display = 'none';			document.getElementById(imid).src = 'inform:/extra.png';		} else {			document.getElementById(id).style.display = 'block';			document.getElementById(imid).src = 'inform:/extraclose.png';		}	}    function openExtra(id, imid) {    	document.getElementById(id).style.display = 'block';    	document.getElementById(imid).src = 'inform:/extraclose.png';    }    function closeExtra(id, imid) {    	document.getElementById(id).style.display = 'none';    	document.getElementById(imid).src = 'inform:/extra.png';    }</script></head><STYLE TYPE="text/css"><!--*, *:before, *:after {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.oval, .oval TD{background-image:url('../../doc_images/ovoid.png');color:white;}--></STYLE><body><script language="JavaScript">function pasteCode(code) {    var myProject = window.Project;    myProject.selectView('source');    myProject.pasteCode(code);}</script><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><table CELLPADDING=0 CELLSPACING=0 width="100%" bgcolor="#000000"><tr><TD width=38px height=26px align="center" valign="center"></td><TD width=38px height=26px align="center" valign="center"></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0></td><TD width=56px height=26px align="right" valign="center"></td></tr></table><p><img border=0 src=../../doc_images/paste.png>&nbsp;<b>Glimmr Canvas Animation<font color="#404040"> by </font>Erik Temple</b><p><small></small><p><p><hr><p>
<p>
 Glimmr Canvas Animation (GCA) extends Glimmr Canvas-Based Drawing, allowing for graphic elements of any type to be animated. GCA includes a number of presets that make even complex animations a matter of just a few lines of code, including motion, flipbook-style, zooming, flickering, and more. There is also support for &quot;tweening&quot;, using a number of different easing equations (authors can also add their own). Authors can also create completely custom animation routines that do whatever they like.
<p>
 Section: The state of animation in Glulx
<p>
 Glulx has no built-in animation support. Instead, animation is achieved through what is essentially a hack: we start a repeating timer, and every time that timer &quot;ticks&quot;, we update the display. Unlike true game animation engines, which skip frames to maintain the timing when the processor is unable to realize the requested framerate, Glulx simply skips timer ticks: every frame of the animation will be shown, and the animation will simply unfold more slowly than intended if the processor can't keep time.
<p>
 Moreover, the Glulx timer is explicitly not intended to be perfectly reliable. Some interpreters have better timer implementations than others, and combined with performance variability in graphics drawing and other operations, this means that the precise performance of a given animation is not guaranteed to be the same on different Glulx virtual machines.
<p>
 Finally, many standard graphical effects are not provided in Glulx. Glulx does allow for images to be scaled, but we cannot dynamically rotate a sprite, for example, nor can we affect the opacity of an image. There are labor-intensive ways to at least partially get around these (basically, create multiple versions of each sprite, at different opacities or rotations), but they are limiting.
<p>
 Despite all this, animation in Glulx can still work pretty well, as long as we keep things simple and don't expect *too* much from the system. We will also want to test our game on a few different interpreters and systems before releasing it to the world-if it works better in some 'terps than others, we want to be able to communicate that to players.
<p>
 The timer approach to animation makes simple animations fairly easy to write, especially when combined with the object-oriented approach taken by Glimmr Canvas-Based Drawing. For example, even without this Canvas Animation extension, we would be able to animate &quot;zooming in&quot; on an image with just a few lines. GCA, however, leverages Glimmr Canvas-Based Drawing to provide a number of different animation presets, so that something like this can be invoked with just a single line of code. GCA also provides the ability to use &quot;easing&quot; equations to influence the time-curve of animated movement. GCA's concept of the &quot;animation track&quot; allows you to write your own animation rules, and even to animate text or game events rather than graphics.
<p>
 Chapter: Including Glimmr Canvas Animation in a project
<p>
 Inform remains fairly unsophisticated in its mechanisms for organizing included extensions. When we are dealing with a complex system of modular extensions such as Glimmr, it is very easy to trip it up, and the result is usually a list of unhelpful errors. For this reason, each Glimmr extension includes a section-such as this one-about how to include it, particularly in relation to other extensions.
<p>
 Glimmr Canvas Animation automatically includes Glimmr Canvas-Based Drawing, Glimmr Drawing Commands, Flexible Windows, and their dependencies. You do not need to include any of these extensions explicitly in your story file; GCA will include them automatically (provided they are installed with your copy of Inform, of course).
<p>
 If you are using Glimmr Graphic Hyperlinks you MUST include it before Glimmr Canvas Animation. Conversely, you must include any Glimmr font, tileset, or fader extensions after GCA. For example:
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> Include Glimmr Graphic Hyperlinks by Erik Temple.<br> Include Glimmr Canvas Animation by Erik Temple.<br> Include Glimmr Image Font by Erik Temple.</font></blockquote>
<p>
 Section: A note on compatibility
<p>
 Glimmr Canvas Animation uses a rudimentary system of &quot;virtual timers&quot; to enable animations to run at different speeds despite the fact that Glulx has only a single timer. This means that GCA is probably incompatible with any other real-time extension, at least if we are hoping to track real-time and animation events at the same time.
<p>
 Chapter: Getting started with Glimmr Canvas Animation
<p>
 Before you can do any work with Glimmr Canvas Animation, you will need to set up at least one graphics window in your project. Please refer to the documentation for Jon Ingold's Flexible Windows extension for more information. You can also copy the window-related code from the examples in GCA if you just want to get started quickly.
<p>
 Once you have a graphics window, you will also need to set up a Glimmr canvas and add some graphics elements-that way you'll have something to animate! See the Glimmr Canvas-Based Drawing extension for instructions and a number of examples. Of course, you can also just plunder the examples in GCA if you just want to get a feel for how things work.
<p>
 Next, you will create one or more &quot;animation tracks&quot;. Each track controls a single animation effect acting on a single graphics object (either a single sprite, a canvas, or an entire window's display). Multiple tracks can run at the same time; for example, one track might move an image across the screen, while the other makes it smaller and smaller until it disappears. Creating a track is as simple as:
<p>
<blockquote><font color="#000080"> The movement track is an animation track.</font></blockquote>
<p>
 To actually make that track do something, apply an animation preset to it via a phrase like this, placed in the rule that you want to trigger the animation:
<p>
<blockquote><font color="#000080"> animate the movement track as a motion animation targeting My Sprite and ending at { 500, 100 } at 250 milliseconds per frame with a duration of 12 frames</font></blockquote>
<p>
 That is all that is required to create a 12-frame animation that moves the sprite from its current position to coordinate (500, 100). The extension will automatically update the graphics window or windows involved, and will stop the timer when all animations have finished.
<p>
 Some animations will require a bit more setup. For example, a reel animation requires you to predefine a list of the images to be shown:
<p>
<blockquote><font color="#000080"> The image-reel of the flipbook track is { Figure 1, Figure 2, Figure 3, Figure 5, Figure 4 }.</font></blockquote>
<p>
 Many types of GCA animation also allow you to specify &quot;easing&quot; to adjust the speed, timing, or even path of motion (see http://glimmr.wordpress.com/2011/06/11/animation-demo-series-2/ for an introduction to easing). This is completely optional, and is again accomplished with a single line, e.g.:
<p>
<blockquote><font color="#000080"> The easing of the movement track is the cubic easing out rule.</font></blockquote>
<p>
 See the appropriate sections below for more information on animation tracks, the animation presets available and how to invoke them, easing (also known as tweening), and other topics. There are also a number of in-depth examples at the end of this documentation. More discussion of some of the examples can also be found at glimmr.wordpress.com:
<p>
<blockquote><font color="#000080"> http://glimmr.wordpress.com/2011/06/05/glimmr-animation-series-1/<br> http://glimmr.wordpress.com/2011/06/11/animation-demo-series-2/<br> http://glimmr.wordpress.com/2011/06/23/animation-demo-series-3/</font></blockquote>
<p>
 Chapter: Animation and the timer
<p>
 Animations are controlled by the Glulx virtual machine's timer functionality. The Glulx timer is global-there is only one &quot;ticker&quot; -but GCA uses &quot;virtual timers&quot; to allow simultaneous animations to run at different speeds.
<p>
 When only one animation is running, or when all running animations are running at the same rate, then each tick of the global timer represents one &quot;frame&quot; of animation. When we specify multiple rates of animation, however, GCA works out how to subdivide the timer interval so that each animation fires at the requested rate. For example, if we trigger Animation A at 80 milliseconds per frame, and Animation B at 160 milliseconds per frame, then the timer will fire at 80 milliseconds per frame, with Animation A firing every frame, and Animation B every 2 frames.
<p>
 Users of Glimmr Canvas Animation's animation tracks will rarely if ever need to deal with the timer directly, as the commands for invoking animation tracks automate the process. If needed, though, we can find out what the current interval between ticks of the global timer is by referring to the &quot;global timer interval&quot; global variable (the timer for any given animation track can be got at by checking the &quot;timer interval&quot; property of the track):
<p>
<blockquote><font color="#000080"> say &quot;The interval between ticks is [global timer interval] milliseconds.&quot;</font></blockquote>
<p>
 The &quot;global timer interval&quot; variable is dynamic: it only contains a value when there is a timer running, and resets to zero when the timer stops. Note that we should *never change* the variable directly; doing so will not change the interval. If we want to set a new interval, we simply need to invoke an animation track, or change the timer directly, like so:
<p>
<blockquote><font color="#000080"> start a Glulx timer of 200 milliseconds</font></blockquote>
<p>
 Any time we start a new timer, GCA will look at any animations that may be running and adjust the rate we've requested to maintain their rates. It is probably best never to set the timer directly when animations are involved-just use the &quot;animate...&quot; phrases, detailed below, to trigger animations.
<p>
 The timer can, of course, run independently of animations. If we want to use the timer for some other purpose in our game, we are welcome to simply start the timer using the same phrase, without using an animation preset. Animations are not activated unless we specifically start them with an animation phrase. It is not a good idea to try to use timed events for other purposes while animations are running-when animations are running, the virtual timer system is invoked, which may cause unpredictability in timed behaviors that don't take that system into account. You can study the source code to see how you might take the system into account, but the easiest way to deal with the situation is to use custom animation tracks-see the chapter on custom animation below-to control all of your non-graphical timed events. This will allow them to use the virtual timer system.
<p>
 To stop *all* running timers, use:
<p>
<blockquote><font color="#000080"> pause the Glulx timer</font></blockquote>
<p>
 Warning: This will stop the timer, but any animations that are running will still be marked as active. If you start another timer, they will begin again, and they will also be factored into the virtual timer system.
<p>
 Section: Implementation details
<p>
 At each tick of the timer, Inform calls the &quot;glulx timed activity&quot; rulebook (provided by Emily Short's Glulx Entry Points extension). If one or more of our animation tracks is active, the &quot;animation dispatch rule&quot;, one of the timed activity rules, will fire. This rule iterates through all of the active animation tracks, processing each in turn. This processing occurs in the &quot;animation&quot; rulebook. Most users will not need to add rules to the animation rulebook, but it is necessary to do so to create custom animations (see below), and it can sometimes be useful if we wish to trigger other events from within preset animations, rather than via callbacks at the end. See the &quot;Animation Rule Variations&quot; example below for some illustrations.
<p>
 Note that the rules in the animation rulebook are intended for making changing to the properties of targeted objects/elements, not for actually drawing to the screen. Once all of the tracks have been processed, the &quot;updating graphics windows for animation&quot; activity is called. There is only one rule in this activity, the &quot;animation window-updating rule&quot;, which updates the graphics in each of the open graphics windows. If we have a number of static graphics windows alongside one with animation, we can improve performance by preempting this rule with one of our own that updates only the window with animations. (Otherwise, we are needlessly redrawing all windows every tick of the timer.)
<p>
 Section: Undo, Save, Restore
<p>
 GCA handles undo and restore transparently:
<p>
<blockquote><font color="#000080"> UNDO - The Inform library saves the state of the game just before getting input, at the beginning of a new turn. When the player types UNDO, the game will resume where it was when the state was saved, with any animations picking up exactly where they were.</font></blockquote>
<p>
<blockquote><font color="#000080"> SAVE - Inform saves the game at the moment that the player confirms the intention to save the game. Again, when the game is restored, GCA will pick up exactly where it left off.</font></blockquote>
<p>
 Implementation note:
<p>
 The Glulx virtual machine does not store the state of the timer when saving the state of the game. That means that we need to do that ourselves in order to properly restore the game or undo a previous turn. GCA takes care of this for us by storing the timer interval in a global variable, and then either triggering the timer at the appropriate speed or turning it off as appropriate immediatedly after restoring or undoing. If we are making changing to save/restore, the after restoring the game rules, or undo code, we should be sure that we don't break this functionality.
<p>
 Chapter: Animation tracks
<p>
 GCA simplifies the specification of animations through the concept of the &quot;animation track&quot;. An animation track handles one and only one kind of animation effect for one and only one graphic element. However, tracks are &quot;stackable&quot; -you can run multiple tracks simultaneously-so you can build up very complex animations. To display a person walking, for example, you might have two tracks running simultaneously, one responsible for the motion of the sprite from point A to B, and the other for cycling the image used to represent the sprite.
<p>
 Animation tracks can also do such things as increase or decrease the scaling factor of an element (&quot;zooming&quot; it), fade an element or the entire canvas out to a background color, or simply mark time.
<p>
 Section: Basics of animation tracks
<p>
 In programming terms, an animation track is an Inform 7 object, not too different from the &quot;things&quot; that authors use to build their storyworlds. However, they are not intended to be physical game objects; they are simply convenient containers for storing and organizing information, usually in the form of properties. (Users of Glimmr Canvas-Based Drawing will recognize the same concept in the use of g-elements, which are also objects in the same sense.) Defining an animation track is quite simple. Here we do two at a stroke:
<p>
<blockquote><font color="#000080"> The movement track and the walking track are animation tracks.</font></blockquote>
<p>
 Rather than requiring us to set each of the relevant properties individually, GCA allows us to use an abbreviated, single-phrase command to set up and trigger each animation track, by using animation presets. The code for the walking animation mentioned above might look like this, for example:
<p>
<blockquote><font color="#000080"> animate the movement track as a motion animation targeting the Walker and ending at { 300, 100 } at 12 fps with duration of 24 frames;<br> animate the walking track as a reel animation targeting the Walker at 12 fps with duration of 24 frames, cycling.</font></blockquote>
<p>
 Note the reference to &quot;motion&quot; and &quot;reel&quot; -these are two of the types of animation preset provided by GCA. Motion tracks animate the movement of an element across the canvas/window, while reel tracks change the image used to display the element. See the sections that detail the different presets below.
<p>
 Some circumstances will require us to manually set properties of the track in addition to the command. For example, all reel tracks require us to specify the list of images that make up the &quot;reel&quot; that will be displayed. Here is the full code required to set up a reel animation:
<p>
<blockquote><font color="#000080"> The waving track is an animation track. The image-reel of the waving track is { Figure of Hand Left, Figure of Hand Right }.</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of waving hands:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the waving track as a reel animation targeting the player avatar at 4 fps with duration of 6 frames.</font></blockquote>
<p>
 This will animate the reel for 6 frames at a rate of 4 frames per second; that is, with a timer tick every 250 milliseconds. Each frame, the image used to display the sprite element we have called &quot;player avatar&quot; will change according to the image-reel list we have defined. Note that since the reel has only two images in it, the track will select the first figure for 1 frame, and the second figure for 5 frames. If we want to repeat the reel after reaching the end, we add the &quot;cycling&quot; option:
<p>
<blockquote><font color="#000080"> animate the waving track as a reel animation targeting the player avatar at 4 fps with duration of 6 frames, cycling.</font></blockquote>
<p>
 This will repeat through the reel for each pair of frames, producing a smooth alternation of the figures: Figure of Hand Left, Figure of Hand Right, Figure of Hand Left, Figure of Hand Right, Figure of Hand Left, Figure of Hand Right. More information on the cycling option is given below.
<p>
 Note that the timer is started *immediately* after an animate phrase is invoked. The animation will begin after one interval has passed. In other words, the first frame of the animation will be displayed after one tick of the timer; if we have specified an interval of 4 frames per second, the first frame will be displayed 250 milliseconds after Inform processes the animation phrase.
<p>
 To summarize, the basic steps for defining an animation are:
<p>
<blockquote><font color="#000080"> 1) Declare the track object: &quot;X is an animation track&quot;<br> 2) Set up any auxiliary properties that need setting up, e.g. &quot;The image-reel of X is {....}&quot;<br> 3) Invoke the track using the encapsulated command: &quot;animate X as a...&quot;</font></blockquote>
<p>
 Tracks are fully recyclable, meaning that once a track is done running, we can invoke it again with a totally different set of parameters. We can even change the type of the animation if we wish, e.g.:
<p>
<blockquote><font color="#000080"> animate the default track as a motion animation...<br> (later...)<br> animate the default track as a reel animation...</font></blockquote>
<p>
 Unless we are obsessed with efficiency, though, it probably isn't the best idea to reuse a track for a totally different purpose in this way. It won't be quite as easy to read the code later. Study the &quot;Scourge of the Vampyr&quot; example to see how multiple tracks can be used alone and together to both organize and control animations.
<p>
 GCA includes one pre-declared animation track, called the &quot;default track&quot;. We can make use of this track or not in our own game as we like.
<p>
 See below for the different types of animation preset, the commands used to invoke them, and brief usage examples.
<p>
 Section: Animation callbacks
<p>
 A callback is a function that fires once the animation has finished. Callbacks can in principle do anything: start or start another animation track, play a sound, print some text, etc. An animation track can have one or more associated callback routines associated.
<p>
 At first glance, the implementation of callbacks in GCA may seem a bit odd, and in fact it is something of an experiment. Rather than assign a rule to be fired, we use a text, stored in the track's &quot;animation-callback&quot; property. At its simplest, this just means that we print a text when the animation completes, e.g.:
<p>
<blockquote><font color="#000080"> The animation-callback of the default track is &quot;Whew!&quot;</font></blockquote>
<p>
 But thanks to a little trick from John Clemens (http://www.math.psu.edu/clemens/IF/I7tricks.html), we can actually invoke standard Inform phrase functions, like so:
<p>
<blockquote><font color="#000080"> The animation-callback of the default track is &quot;[@ animate the default track as a reel animation targeting the player-avatar at 6 frames per second]&quot;.</font></blockquote>
<p>
 The &quot;@&quot; indicates that Inform should read the text substitution that follows as a phrase to be executed. We can chain all this stuff together, e.g.:
<p>
<blockquote><font color="#000080"> The animation-callback of the default track is &quot;The wheel reverses direction[@ now the image-reel of the Wheel is the reverse-reel][@ animate the default track as a reel animation targeting the Wheel at 8 frames per second].&quot;</font></blockquote>
<p>
 The ability to combine straight printing, &quot;to say&quot; phrases, and standard function phrases in a single statement makes for a compact and flexible approach to callback functions.
<p>
 Note that we are bound by the usual restrictions on the content of text substitutions. In particular, they cannot contain commas or brackets of any type, which means that we will need to define intermediary phrases in order to refer to Glimmr coordinates or to provide phrase options, which are separated from their phrase by a comma.
<p>
 Section: Delaying input until animations finish
<p>
 By default, animations will continue to run while other game functions are operating-the player will be free to continue typing commands and so on while animation in underway. Sometimes, though, we may want to pause the textual part of our game while an animation plays out. We can do this with one of two different commands:
<p>
<blockquote><font color="#000080"> delay input until all animations are complete<br> delay input until &lt;track&gt; is complete</font></blockquote>
<p>
 These phrases prevent the game from asking for commands from the player until either *all* animations have completed (the first phrase), or until a specific animation has completed (the second phrase).
<p>
 The best place to place a delay instruction is usually immediately after the &quot;animate&quot; lines it is associated with. For example:
<p>
<blockquote><font color="#000080"> animate the walking track as a reel animation targeting the player-sprite at 8 fps, cycling;<br> animate the waypoint movement track as a motion animation targeting the player-sprite and ending at { 421, 242 } at 8 fps with velocity of 10;<br> delay input until all animations are complete;<br> say &quot;Done!&quot;.</font></blockquote>
<p>
 The game will pause immediately, and only code that fires due to animation, or to other timer events, will be run. The say phrase at the end of the block of code above will not print until the animation has completed.
<p>
 Section: Manually activating and deactivating tracks
<p>
 An animation track can be turned on or off manually using the following phrases. The most likely use for this functionality is to pause and restart one track while other animations are running.
<p>
<blockquote><font color="#000080"> activate &lt;track&gt;<br> deactivate &lt;track&gt;</font></blockquote>
<p>
 Note that the timer must *also* be running for a track so activated to actually run. We can find out whether any of our animation tracks is flagged as active by using:
<p>
<blockquote><font color="#000080"> if animation is queued...</font></blockquote>
<p>
 We can test whether a *given track* is currently active by looking at its &quot;animation-flag&quot; property, which can be either &quot;g-active&quot; or &quot;g-inactive&quot;:
<p>
<blockquote><font color="#000080"> if the animation-flag of the default track is g-active...</font></blockquote>
<p>
 If we need to, we can ask whether there are any *currently running* animations, using this phrase:
<p>
<blockquote><font color="#000080"> if animation is underway...</font></blockquote>
<p>
 This will return true only if an animation is flagged as active *and* the timer is running.
<p>
 We can change the speed of an animation once it is already underway:
<p>
<blockquote><font color="#000080"> time &lt;track&gt; at &lt;interval&gt; milliseconds</font></blockquote>
<p>
 This should *only* be done when the animation is already running. It will adjust the global timer to utilize the newly selected speed.
<p>
 Another useful phrase is &quot;cease animating &lt;track&gt;&quot;, which like &quot;deactivate &lt;track&gt;&quot;, will immediately stop the indicated track. However, the latter merely stops the track, while the former also fires the callback of the track that was stopped. For example, if Track A moves an object to a given point while Track B cycles through a short sequence, we could use either phrase to as a callback on Track A to stop Track B. However, only the &quot;cease animating&quot; phrase will also fire Track B's callback:
<p>
<blockquote><font color="#000080"> Track A is an animation track. The animation-callback is &quot;[@ cease animating Track B]&quot;.<br> Track B is an animation track. The animation-callback is &quot;All done.&quot;</font></blockquote>
<p>
 Section: Changing track modalities
<p>
 We can force a track into cycling or randomizing-or stop either of those modalities-once the animation is already running. Most often, we will do this via a callback routine, though we could also do it in response to player input. For example, we could cycle one animation until another animation completes. The second animation would then send a callback to the first to tell it to stop cycling.
<p>
 The phrases required are straightforward:
<p>
<blockquote><font color="#000080"> cycle &lt;track&gt;<br> stop cycling &lt;track&gt;</font></blockquote>
<p>
<blockquote><font color="#000080"> randomize &lt;track&gt;<br> remove randomization from &lt;track&gt;</font></blockquote>
<p>
 Chapter: Animation track presets
<p>
 Each animation track will trigger a different rule from the &quot;animation&quot; rulebook, depending on the preset that is associated with it. For example, the &quot;zooming&quot; preset triggers the &quot;default zooming animation rule&quot;, which will, for each frame of the animation, set the scaling factor of the target element to an appropriate value.
<p>
 The specific parameters available for each track preset are laid out in the sections below, but the basic form for the invocation of an animation track is this:
<p>
<blockquote><font color="#000080"> animate &lt;animation track&gt; as a &lt;preset&gt; animation targeting the &lt;target&gt;... at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;options&gt;</font></blockquote>
<p>
 The items in angle brackets are present in nearly all of the commands; here are quick explanations for each of them:
<p>
<blockquote><font color="#000080"> preset - this is the type of the animation, e.g. motion, reel, zooming, etc.</font></blockquote>
<p>
<blockquote><font color="#000080"> target - this is the object that will be affected by the animation. Usually, this will be a graphic element, but it might also be the canvas itself, or the window framing the canvas (see the individual presets below for more information).</font></blockquote>
<p>
<blockquote><font color="#000080"> interval - this is the time between frames. It can be expressed either by specifying it directly, e.g. &quot;200 milliseconds per frame&quot;, or by providing the frames per second we desire, e.g. &quot;12 frames per second&quot; or just &quot;12 fps&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> length - the number of frames in the animation. Note that this term is optional for some types of preset. If we don't specify a length for these presets, the animation will be automatically set to the most likely.</font></blockquote>
<p>
<blockquote><font color="#000080"> options - we can add one or more options, depending on the type of preset; see the next section.</font></blockquote>
<p>
 As you read the following sections, you may also want to refer to the documentation for Glimmr Canvas-Based Drawing for a refresher on graphic element types and their properties.
<p>
 Section: Track options
<p>
 There are two track options that we can select by adding a comma and the option or options after the body of the command phrase, like so:
<p>
<blockquote><font color="#000080"> animate..., cycling and randomized</font></blockquote>
<p>
 These options are defined as follows:
<p>
<blockquote><font color="#000080"> cycling - an animation track that has been designated as cycling will not stop when it reaches the end; instead, it will begin again at the beginning.</font></blockquote>
<p>
<blockquote><font color="#000080"> randomized - a randomized track will select the state of any given frame at random from the available options.</font></blockquote>
<p>
 Note that any animation track can be cycling, but tracks that involve smooth movement (such as motion or zooming tracks) cannot be randomized.
<p>
 Section: Frames, cycles, and duration
<p>
 Animation tracks keep an accounting of their own states. We will rarely need to access this information, but should we need to, we can refer to these properties of any given track:
<p>
<blockquote><font color="#000080"> current-frame - a number that indicates how many frames, in total, an animation has passed through.</font></blockquote>
<p>
<blockquote><font color="#000080"> animation-length - the duration (in frames) that the track will run before finishing.</font></blockquote>
<p>
<blockquote><font color="#000080"> cycle-length - the number of frames in a single cycle of the animation. If the animation is not cycling, this will be the total duration specified for the animation.</font></blockquote>
<p>
<blockquote><font color="#000080"> cycles completed - the number of cycles of the animation that have been completed.</font></blockquote>
<p>
 GCA does not store the frame of the current cycle, but it can be calculated as follows:
<p>
<blockquote><font color="#000080"> let cyclic-frame be the current-frame of the track - (cycle-length of the track * cycles completed of the track)</font></blockquote>
<p>
 Chapter: Standard track presets
<p>
 Detailed descriptions of the track presets are given below, including the types of objects that they can act on, their effects, the phrases used to create/invoke them, and examples of usage.
<p>
 Section: Reel animation tracks
<p>
 &quot;Reel&quot; tracks show a succession of images in a way similar to that of traditional animation on film, or the animated GIFs familiar from the web. The sequence of images to be shown is specified using a list of figure names assigned to the track's &quot;image-reel&quot; property. Reel tracks can function only with entities that display a single image at a time, and thus we are limited to targeting:
<p>
<blockquote><font color="#000080"> sprites (g-element)<br> g-canvas (affecting the background image of the canvas)</font></blockquote>
<p>
 (But see the &quot;parameterized reel&quot; preset below, which lets us define a reel for any display property of any kind of g-element, canvas, or g-window.)
<p>
 The reel must be defined in advance of triggering the animation track; this is done by setting the &quot;image-reel&quot; property of the animation track object to a list of figure names. (We can repeat figure names in the list to show the figure a second time; this can be used to provide pacing.)
<p>
 To invoke a reel preset we use the following phrase:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a reel animation targeting &lt;target&gt; at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;&lt;randomized&gt;</font></blockquote>
<p>
 If we wish, we may omit the duration, resulting in this variant phrasing:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a reel animation targeting &lt;target&gt; at &lt;interval&gt;, &lt;cycling&gt;&lt;randomized&gt;</font></blockquote>
<p>
 If we do this, the duration will be set automatically to the number of entries in the image-reel. Moreover, if we also set the &quot;cycling&quot; option when no duration has been set, the track will continue to repeat ad infinitum, or until stopped by another event (such as a callback from another track; see the section on callbacks below).
<p>
 The images in the image-reel list will be shown in order, unless we set the &quot;randomized&quot; option for a reel track, in which case an image will be chosen at random from the reel for each frame. (We can of course include multiple mentions of the same figure to influence percentages; if Figure 1 is listed twice in the reel while Figure 2 is listed just once, then the chance that Figure 1 will be displayed is twice as great as the chance that Figure 2 will be.)
<p>
 Here are some examples of usage (code snippets, not complete games):
<p>
 Targeting a sprite, showing each frame in the reel just once:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The leaping track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The image-reel of the leaping track is { Figure of Leap 01, Figure of Leap 02, Figure of Leap 03, Figure of Leap 04 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Frog is a sprite. The image-ID is Figure of Frog Sitting.</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of jumping:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the leaping track as a reel animation targeting the Frog at 200 milliseconds per frame with a duration of 4 frames.</font></blockquote>
<p>
 Targeting a canvas and using the shorter form. Note that because the &quot;cycling&quot; option is set and there is no duration specified, this track will repeat endlessly:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The swirling track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The image-reel of the swirling track is { Figure of Swirl 01, Figure of Swirl 02, Figure of Swirl 03, Figure of Swirl 04, Figure of Swirl 05 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> The background image of the graphics-canvas is Figure of Still Water.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the swirling track as a reel animation targeting the graphics-canvas at 12 frames per second, cycling.</font></blockquote>
<p>
 Reel tracks normally are not affected by setting the easing equations. However, if AFTER using the animate phrase we reset the length of the animation cycle so that it is not equal to the number of entries in the image-reel, easing will be used to reconcile the two. Effectively, the easing equation will describe how time will be &quot;stretched&quot; to fit the reel. The animation rule will use the easing of the track to extend or contract the length of the animation using the frames in the original reel. For example, if our original image reel was specified as a list with four entries, and we then fit the sequence to 12 frames using the linear easing rule, each of the four images in the original would be displayed for approximately 3 frames. If we are using a rapid in, slow out easing equation, however, then the first entry in the reel list might be displayed for only one frame, while the last might be held for four frames. Note that, due to rounding errors, this will not always work perfectly, particularly when the original reel sequence specified is short. We achieve this effect by using the &quot;fit... sequence to ... frames&quot; phrase:
<p>
<blockquote><font color="#000080"> fit &lt;track&gt; sequence into/to &lt;length&gt; frame/frames</font></blockquote>
<p>
 Extending the example above:
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The swirling track is an animation track. The easing of the swirling track is the quadratic easing out rule.</font></blockquote>
<p>
<blockquote><font color="#000080"> The image-reel of the swirling track is { Figure of Swirl 01, Figure of Swirl 02, Figure of Swirl 03, Figure of Swirl 04, Figure of Swirl 05 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> The background image of the graphics-canvas is Figure of Still Water.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the swirling track as a reel animation targeting the graphics-canvas at 8 frames per second, cycling;<br>&nbsp;&nbsp;&nbsp;&nbsp; fit the swirling track sequence to 12 frames.</font></blockquote>
<p>
 The &quot;fit... sequence to ... frames&quot; phrase works *only* with reel and parameterized reel tracks. It will have unanticipated effects if used with other types of animation track preset.
<p>
 Section: Motion animation tracks
<p>
 &quot;Motion&quot; tracks change the origin coordinate of the target object. If we attempt to target an object that doesn't have the origin property, Inform with throw a run-time error (error P10). The standard Glimmr objects that will support motion animations, then, are:
<p>
<blockquote><font color="#000080"> any g-element<br> graphics g-window</font></blockquote>
<p>
 (We can, of course, create our own kind of object, and as long as it has the &quot;origin&quot; property, we will be able to animate it with a motion animation track.)
<p>
 When a g-element that has an endpoint (boxes, rectangles, lines) is animated using the motion animation phrase, the endpoint will be changed along with the origin, so that the shape will move as a unit. If we want to do more complex effects-such as moving the endpoint without moving the origin, or vice versa-then we should use the &quot;parameterized motion&quot; preset (see below).
<p>
 When a graphics g-window is targeted by the motion animation phrase, then the framing of the canvas in the window is changed. See Glimmr Canvas-Based Drawing for an explanation of the origin coordinate of windows vis-a-vis their canvases.
<p>
 A motion animation always moves the object from its current position to the ending position we specify; the starting position of the object is not directly provided in the animation phrase. To invoke a motion preset animation we can use one of the following two phrases:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a motion animation targeting &lt;target&gt; and ending at &lt;final position&gt; at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;</font></blockquote>
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a motion animation targeting &lt;target&gt; and ending at &lt;final position&gt; at &lt;interval&gt; with a velocity of &lt;velocity&gt; units, &lt;cycling&gt;</font></blockquote>
<p>
 The second phrase allows us to specify the velocity (in canvas units per frame; see Canvas-Based Drawing for the concept of canvas units/pixels); the number of frames required to move to the ending position at the given velocity will be calculated automatically.
<p>
 If we set the &quot;cycling&quot; option, the animation will start again from the beginning upon completion, ad infinitum or until stopped by another event (such as a callback from another track; see the section on callbacks below).
<p>
 Some examples of usage:
<p>
 Targeting a sprite element, and specifying the length of the animation rather than the speed:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The run-movement track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> Lola is a sprite. The origin is { 0, 100 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of running:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the run-movement track as a motion animation targeting Lola and ending at { 400, 100 } at 8 fps with a duration of 24 frames.</font></blockquote>
<p>
 Targeting a rendered string element, specifying the velocity rather than the duration of the animation. The text will move in from off the canvas, while an easing equation adds visual interest to the path of movement.<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The title bounce track is an animation track. The easing is bounce easing out.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Title Text is an image-rendered string. The text-string is &quot;Your Title Here&quot;. The origin is { 300, -100 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the title bounce track as a motion animation targeting the Title Text and ending at { 300, 300 } at 20 frames per second with a velocity of 10.</font></blockquote>
<p>
 Targeting a rectangle primitive, and cycling endlessly. We are depicting a 1980s style videogame bullet (i.e. a square) shot repeatedly from a gun turret.<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The gatling shot is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Bullet is a rectangle primitive. The origin is { 100, 150 }. The endpoint is { 104, 154 }. The tint is g-White.</font></blockquote>
<p>
<blockquote><font color="#000080"> To activate the turret:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the gatling shot as a motion animation targeting the Bullet and ending at { 600, 150 } at 10 fps with a velocity of 8, cycling.</font></blockquote>
<p>
 Motion animations, as well as parameterized motion animations (see below), can use easing equations to influence the timing and path of movement. Because motion animations can move on two axes (i.e., the x and y axes), we can also use different easing equations simultaneously on the two axes. If we specify only the &quot;easing&quot; for the track, then the same easing equation will be applied to both axes. If we also supply the &quot;secondary easing&quot; for the track, then the easing will apply to the x axis, while the secondary easing applies to the y axis. To reset a track to the defaults after using secondary easing, we specify the &quot;null easing rule&quot; for the secondary track, e.g.
<p>
<blockquote><font color="#000080"> now the easing of the default track is the linear easing rule;<br> now the secondary easing of the default track is the null easing rule.</font></blockquote>
<p>
 See the &quot;Eased Movements&quot; example to explore the effect of easing, including differential axis easing, on animated movement.
<p>
 Section: Zooming animation tracks
<p>
 &quot;Zooming&quot; tracks affect the scaling of an object, allowing us to &quot;zoom&quot; graphics in or out. Zooming tracks can be function with:
<p>
<blockquote><font color="#000080"> g-elements<br> graphics g-windows</font></blockquote>
<p>
 When targeting a g-element, a zooming animation affects the &quot;scaling factor&quot; property of the element. The effect this has depends on the type of g-element; only the line-weight of primitives is affected by the scaling factor, and the scaling factor of bitmaps is much more coarsely realized than that of images. See the docs for Glimmr Canvas-Based Drawing for more information. (Note that if you are using asymmetrically scaling, the zooming track will nevertheless scale symmetrically. Use the &quot;parameterized zooming&quot; preset-see below-to scale axes independently.)
<p>
 When targeting a graphics window, the property affected is the &quot;arbitrary scaling factor&quot; of the window. This forces manual scaling of the window (see Glimmr Canvas-Based Drawing), so if we wish to return to automatic scaling after completing the animation, we will need to reset the arbitrary scaling factor and trigger a redraw, e.g.:
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> now the arbitrary scaling factor of the graphics-window is 0.0000;<br> refresh windows.</font></blockquote>
<p>
 If we attempt to target a canvas, we will instead affect *all* windows that currently display the canvas. This is only advisable if all of these windows are set to the same scaling factor/arbitrary scaling factor, because the scaling factor of the last window to be created will be used for all windows during the animation.
<p>
 Note that, to avoid aesthetic abomination, Glimmr normally does not allow the canvas to be scaled at larger than actual size. This can be changed, however, on a window-by-window basis, like so. For example:
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> Oversize scaling of the graphics-window is true.</font></blockquote>
<p>
 Also note that whether we are targeting a graphic element or a window, content that is automatically centered may show some &quot;jiggle&quot; due to rounding errors. To avoid this problem when zooming an individual element (such as a sprite), we can make sure that the element is &quot;left-aligned&quot; or &quot;right-aligned&quot; rather than &quot;center-aligned&quot; (see Glimmr Canvas-Based Drawing).
<p>
 To invoke a zooming preset, we use the following phrase:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a zooming animation targeting &lt;target&gt; and ending at &lt;final scaling factor&gt; at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;</font></blockquote>
<p>
 If we set the &quot;cycling&quot; option, the animation will start again from the beginning upon completion, ad infinitum or until stopped by another event (such as a callback from another track; see the section on callbacks below).
<p>
 Usage examples:
<p>
 Targeting an image-rendered string element, zooming it from nearly invisible to full-size. An easing equation makes the zoom more dynamic.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The title zoom track is an animation track. The easing of the title zoom track is cubic easing in.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Title Text is an image-rendered string. The text-string is &quot;Your Title Here&quot;. The scaling factor is 0.0001.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the title zoom track as a zooming animation targeting the Title Text and ending at 1.0000 at 20 frames per second with a duration of 12 frames.</font></blockquote>
<p>
 Targeting a box primitive. Because a primitive's size is determined by its endpoint, we can only zoom the weight of the line used to draw the box. This animation, which cycles endlessly, will thus produce a box whose line-weight pulsates:
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The line-pulsation track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Frame is a box primitive. The origin is { 10, 10 }. The endpoint is { 100, 100 }. The line-weight is 1.</font></blockquote>
<p>
<blockquote><font color="#000080"> To start pulsation:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the line-pulsation track as a zooming animation targeting the Frame and ending at 4.0000 at 8 frames per second with a duration of 8 frames, cycling.</font></blockquote>
<p>
 Section: Flicker animation tracks
<p>
 A &quot;flicker&quot; track blinks the targeted object on and off. A flicker can target either of the following:
<p>
<blockquote><font color="#000080"> g-element<br> g-canvas<br> graphics g-window</font></blockquote>
<p>
 Basically, each frame, the targeted object will be toggled on or off. Targeting a canvas, of course, toggles the entire canvas and all of the elements displayed on it; moreover, if the canvas is currently displayed in more than one window, it will flicker in all windows where it is showing. If we target a window, then whatever canvas is shown in that window will be blinked on and off.
<p>
 When targeting a window, we should be sure that there is currently a canvas associated with the window. If no canvas is currently associated with a window, we can bind one to it by setting the window's &quot;associated canvas&quot; property immediately before invoking the animation, e.g.:
<p>
<blockquote><font color="#000080"> now the associated canvas of the graphics-window is the alternate-canvas;<br> animate...</font></blockquote>
<p>
 Canvases are toggled by changing the &quot;associated canvas&quot; property of the window to the &quot;g-null-canvas&quot; (empty, at least by default) and back again. The canvas is stored in the &quot;target-canvas&quot; property of the track.
<p>
 To invoke a flicker animation, we have two options:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a flicker animation targeting &lt;target&gt; at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;&lt;randomized&gt;</font></blockquote>
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a flicker animation targeting &lt;target&gt; at &lt;interval&gt;, &lt;randomized&gt;</font></blockquote>
<p>
 If we set the &quot;cycling&quot; option, the flicker will continue ad infinitum until we stop it (perhaps using a callback on another animation; see the section on callbacks below). For the second option, which specifies no duration, the animation is automatically set to cycle.
<p>
 If we set the &quot;randomized&quot; option, then the pattern of flickering will be randomized. Each frame, there is a 50% chance that the object will be toggled.
<p>
 Usage examples:
<p>
 Targeting a sprite, and cycling endessly:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The neon track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Neon Sign is a sprite. The display status is g-inactive.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the neon track as a flicker animation targeting the Neon Sign at 8 fps.</font></blockquote>
<p>
 Targeting a window with a randomized flicker. Since the flicker is randomized, there is no way to ensure that the animation will end with the canvas visible. We can ensure that it will by specifying an animation callback for the track:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The static track is an animation track. The animation-callback is &quot;[@ now the associated canvas of the graphics-window is the target-canvas of the static track]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> The TV canvas is a g-canvas. The background image is Figure of Color Bars. The associated canvas of the graphics-window is the TV canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> To display static on the television:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the static track as a flicker animation targeting the graphics-window at 8 fps with a duration of 24 frames, randomized.</font></blockquote>
<p>
 Note that easing equations have no effect on flicker tracks!
<p>
 Section: Fade animation tracks
<p>
 &quot;Fade&quot; animations fade in or out from a background color. Glulx does not provide the ability to change opacity dynamically, so this is accomplished by means of a rather terrible hack. Rather than change a property of the target object as other animation presets do, fade tracks actually draw a transparent PNG image on top of the target. By stepping through a series of PNGs with different opacities, we imitate fading in/out.
<p>
 Fade animations require a special kind of Inform object called a &quot;fader&quot;. Like fonts and tilesets, faders are packaged as extensions plus the set of opacity-scaled images. Glimmr includes one sample fader called Glimmr Animation Fader - Black.
<p>
 Fades can be invoked targeting any of these types of object:
<p>
<blockquote><font color="#000080"> g-element<br> g-canvas<br> graphics g-window</font></blockquote>
<p>
 When a g-element is targeted, the PNG image will be sized so that the entire element is covered by the fader overlay. If the target is a canvas, then the canvas dimensions will be faded; if a graphics window, then the entire window will be covered by the overlay. Selecting a canvas that is shown in multiple windows will fade the canvas in all windows simultaneously.
<p>
 By default, all fader overlays will be placed on display-layer 9999. This should be sufficient for nearly all purposes, but can be changed if need be by writing, e.g. &quot;The display-layer of the black-fader is 30000.&quot; (The display layer is the z-level on which a given element is drawn; higher display layers are drawn later. See the documentation for Glimmr Canvas-Based Drawing.)
<p>
 To invoke a fade preset:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a fade animation targeting &lt;target&gt; and using &lt;fader&gt; from &lt;starting percentage&gt; percent to &lt;ending percentage&gt; percent at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;</font></blockquote>
<p>
 We must specify both the starting and the ending percentage for the fader overlay. 100 percent is solid color, while 0 percent is fully transparent. Percentages are specified as integers, and the word percent can be abbreviated using the % sign, e.g.: 90 % (note the space before the symbol: it is required).
<p>
 It is important to remember to manage the before and after states of the animation, since the fader overlay is drawn *only* during the animation. An element that is invisible will be made visible once the animation starts. See the usage examples for pointers.
<p>
 The rate of change of opacities can be controlled via easing equations. This will work best when there are 20 steps or so (as in the black sample overlay).
<p>
 Usage examples:
<p>
 Targeting a sprite, fading in from a black background. We start with the sprite inactive so that it will not be visible until after the animation starts (starting the animation will automatically reveal it).<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The fade-in track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Cover Image is a sprite. The display status is g-inactive.</font></blockquote>
<p>
<blockquote><font color="#000080"> To reveal the cover:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the fade-in track as a fade animation targeting the Cover Image and using the Black-fader from 100 percent to 0 percent at 8 fps with a duration of 12 frames.</font></blockquote>
<p>
 Targeting a canvas, fading out to a black background. When the animation completes, the animation callback will swap the canvas for an empty canvas (the default &quot;g-null-canvas&quot;).<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The fade-out track is an animation track. The animation-callback is &quot;[@ now the associated canvas of the graphics-window is the g-null-canvas]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-canvas is a g-canvas. The background image is Figure of Cover. The associated canvas of the graphics-window is the graphics-canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> To conceal the cover:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the fade-out track as a fade animation targeting the graphics-canvas and using the Black-fader from 0 % to 100 % at 8 fps with a duration of 12 frames.</font></blockquote>
<p>
 The rate of change in opacities can be controlled by easing equations.
<p>
 By default, fader overlays block mouse input to the graphic elements beneath them. Once you start a fade animation over a button, for example, the player will no longer be able to click on the button. To prevent this, you can add this line of code to your source text:
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The graphlink status of a fader overlay is g-inactive.</font></blockquote>
<p>
 Section: Temporalizing animation tracks
<p>
 A &quot;temporalizing&quot; track does nothing at all except count off frames at a given rate. It is intended primarily to be used for delays between animations, and is frequently employed in conjunction with animation callbacks.
<p>
 To invoke a temporalizing preset animation, we can either specify a length or not:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a temporalizing animation at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;</font></blockquote>
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a temporalizing animation at &lt;interval&gt;, &lt;cycling&gt;</font></blockquote>
<p>
 Note that temporalizing animations have no target object-since they don't produce any visual effect, they don't need one. When the &quot;cycling&quot; option is set, a temporalizing animation will continue to cycle until stopped by some outside event, e.g. a callback.
<p>
 Usage example:
<p>
 A sprite moves right, then pauses a bit, then moves back to the left. The temporalizing animation is begun at the same time as the rightward movement, but continues for 6 frames beyond it and then fires a callback to begin the leftward movement:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The patrol track is an animation track.<br> The pause track is an animation track. The animation-callback of the pause track is &quot;[@ complete the patrol]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Patroller is a sprite. The origin is { 0, 100 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> To begin the patrol:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the patrol track as a motion animation targeting the Patroller and ending at { 300, 100 } at 8 fps with a duration of 24 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the pause track as a temporalizing animation at 8 fps with a duration of 30 frames.</font></blockquote>
<p>
<blockquote><font color="#000080"> To complete the patrol:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the patrol track as a motion animation targeting the Patroller and ending at { 0, 100 } at 8 fps with a duration of 24 frames.</font></blockquote>
<p>
 Chapter: Parameterized animation tracks
<p>
 A &quot;parameterized&quot; track is one to which the author must supply the parameter on which the track will act-generally a property of the targeted g-element, canvas, or window. Whereas a reel animation track, for example, works only on the image-ID of a sprite or the background image of a canvas, a parameterized reel track can affect pretty much any visually significant property.
<p>
 A parameterized track can work on only one property of one object at a time.
<p>
 If you are not using any parameterized tracks in your game, you can include the following code in your game to stop the code that supports them from being compiled into the game; this will save a bit on memory.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> Part - Delete parameterized animations (in place of Part - Parameterized animations in Glimmr Canvas Animation by Erik Temple)</font></blockquote>
<p>
 Section: Parameterized reel animation tracks
<p>
 A parameterized reel animation loops through a list of values and assigns those in turn to the chosen parameter. The types of values that can be passed as a parameters are given below; these include more or less all of the visually significant properties provided by Glimmr extensions.
<p>
<blockquote><font color="#000080"> figure names<br> lists of numbers<br> numbers<br> indexed texts<br> lists of lists of numbers<br> lists of lists of figure names<br> objects<br> real numbers</font></blockquote>
<p>
 To set up a parameterized reel, we must supply a list of values (the &quot;reel&quot;) of the same type as the chosen parameter. For example, a reel of figure names targeting the image-ID property of a sprite will produce a result nearly identical to that of using a standard reel animation-a flipbook-like sequence of images. Our reel must be one of the predefined list properties of our track. Here are the names of those list properties, followed by the type of value associated with each.
<p>
<blockquote><font color="#000080"> image-reel - figure names<br> color-reel - texts<br> coordinates-reel - lists of numbers<br> numerical-reel - numbers<br> indexed-text-reel - indexed texts<br> numerical-array-reel - list of lists of numbers<br> image-array-reel - list of lists of figure names<br> associated-objects-reel - objects<br> scaling-reel - real numbers</font></blockquote>
<p>
 To invoke a parameterized reel animation:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a parameterized reel animation targeting &lt;chosen parameter/property&gt; of &lt;target&gt; at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;&lt;randomized&gt;</font></blockquote>
<p>
 If we wish, we may omit the duration, resulting in this variant phrasing:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a parameterized reel animation targeting &lt;chosen parameter/property&gt; of &lt;target&gt; at &lt;interval&gt;, &lt;cycling&gt;&lt;randomized&gt;</font></blockquote>
<p>
 If we do this, the duration will be set automatically to the number of entries in the reel that corresponds to the type of the property we've chosen. And if we set the &quot;cycling&quot; option when no duration has been set, the track will continue to repeat ad infinitum, or until stopped by another event (such as a callback from another track; see the section on callbacks).
<p>
 The entries in the reel list will be shown in order, unless we've set the &quot;randomized&quot; option, in which case an entry will be chosen at random from the reel for each frame. (We can of course include multiple mentions of the same entity to influence percentages; if value A is listed twice in the reel while value B is listed just once, then the chance that value A will be displayed is twice as great as the chance that value B will be.)
<p>
 Examples of usage:
<p>
 The position of the cursor in a bitmap-rendered string:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The wandering cursor track is an animation track. The numerical-reel is { 26, 25, 24, 24, 24, 25, 26, 27 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> Well-Considered Phrase is a bitmap-rendered string. The text-string is &quot;It was a dark and stormy...&quot;. The cursor is 27.</font></blockquote>
<p>
<blockquote><font color="#000080"> To move cursor aimlessly:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the wandering cursor track as a parameterized reel animation targeting the cursor of the Well-Considered Phrase at 6 fps, cycling.</font></blockquote>
<p>
 The position of a sprite, &quot;teleporting&quot; from location to location on the canvas:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The teleporting track is an animation track. The coordinates-reel is { { 10, 10 }, { 152, 45 }, { 345, 12 }, { 72, 72 }, { 0, 400 } }.</font></blockquote>
<p>
<blockquote><font color="#000080"> Bamff is a sprite. The origin is { 330, 330 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> To teleport:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the teleporting track as a parameterized reel animation targeting the origin of Bamff at 2 fps.</font></blockquote>
<p>
 Showing different text strings randomly:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The flashcard track is an animation track. The indexed-text-reel is { &quot;Eat only meats!&quot;, &quot;Capitalize on murder!&quot;, &quot;Fleece your neighbor!&quot;, &quot;Wear plaid!&quot;, &quot;Treacle trickles!&quot; }.</font></blockquote>
<p>
<blockquote><font color="#000080"> The card is an image-rendered string. The text-string is &quot;&quot;. The background tint is g-white.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the flashcard track as a parameterized reel animation targeting the text-string of the Card at 900 milliseconds per frame, randomized and cycling.</font></blockquote>
<p>
 Easing equations normally have no effect on parameterized reel tracks. However, see the section on standard reel tracks above for the use of easing to extend or contract the apparent timing of reel transitions.
<p>
 Section: Parameterized motion animation tracks
<p>
 Parameterized motion tracks are like standard motion tracks (see above), except that they can target any number or coordinate property. Practically, what this means is that we can use a motion track to act on the following properties:
<p>
<blockquote><font color="#000080"> origin (coordinate)<br> endpoint (coordinate)<br> cursor (number)<br> line-weight (number)<br> bit-size (number)</font></blockquote>
<p>
 Clearly, parameterized motion tracks can be used on a much narrower range of properties than parameterized reel tracks; they work only on those numerical properties for which continuous motion is possible.
<p>
 A parameterized motion animation on the origin coordinate is almost exactly equivalent to the basic motion track preset, with the important exception that, for g-elements that have an endpoint property (i.e., primitives), the endpoint is *not* moved along with the origin, as does happen with the motion preset. This allows us to use a parameterized motion animation targeting the origin to move the upper left corner (origin) of a primitive independently of its lower right (endpoint). And of course, targeting the endpoint will move it independently of the origin.
<p>
 To invoke a parameterized motion track:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a parameterized motion animation targeting &lt;chosen parameter/property&gt; of &lt;target&gt; and ending at &lt;end point&gt; at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;</font></blockquote>
<p>
 Or, specifying the average velocity of movement rather than the length of the animation:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a parameterized motion animation targeting &lt;chosen parameter/property&gt; of &lt;target&gt; and ending at &lt;end point&gt; at &lt;interval&gt; with a velocity of &lt;velocity&gt; units, &lt;cycling&gt;</font></blockquote>
<p>
 The &lt;end point&gt; token can be either a coordinate (list of two numbers) or a number (single digit), or a variable containing one of these.
<p>
 Usage examples:
<p>
 Animating the endpoint coordinate of a line, so that it sweeps back and forth across the screen:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The sweeping track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Scanline is a line primitive. The origin is { 200, 100 }. The endpoint of the Scanline is { 0, 0 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the sweeping track as a parameterized motion animation targeting the endpoint of the Scanline and ending at { 400, 0 } at 10 fps with a velocity of 10 units.</font></blockquote>
<p>
 Animating by a simple number rather than by a coordinate. Here we move a cursor from the end of a short text back to the beginning, but with bounce easing set to move it back and forth, a bit aimlessly, along the way:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The wandering cursor track is an animation track. The easing is the bounce easing out rule.</font></blockquote>
<p>
<blockquote><font color="#000080"> Well-Considered Phrase is a bitmap-rendered string. The text-string is &quot;It was a dark and stormy...&quot;. The cursor is 27.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the wandering cursor track as a parameterized motion animation targeting the cursor of the Well-Considered Phrase and ending at 0 at 6 fps with a velocity of 1 unit.</font></blockquote>
<p>
 Parameterized motion animations can use easing equations to influence the timing and path of movement. Because coordinate-based parameterized motion animations can move on two axes (i.e., the x and y axes), we can use different easing equations simultaneously on the two axes. If we specify only the &quot;easing&quot; for the track, then the same easing equation will be applied to both axes. If we also supply the &quot;secondary easing&quot; for the track, then the easing will apply to the x axis, while the secondary easing applies to the y axis. To reset a track to the defaults after using secondary easing, we specify the &quot;null easing rule&quot; for the secondary track, e.g.
<p>
<blockquote><font color="#000080"> now the easing of the default track is the linear easing rule;<br> now the secondary easing of the default track is the null easing rule.</font></blockquote>
<p>
 See the &quot;Eased Movements&quot; example to explore the effect of easing, including differential-axis easing, on animated movement.
<p>
 Section: Parameterized zooming animation tracks
<p>
 A parameterized zooming track is, as might be guessed, very similar to the standard zooming track. It can operate on any of the following four properties:
<p>
<blockquote><font color="#000080"> scaling factor (of a g-element)<br> x-scaling factor (of a g-element)<br> y-scaling factor (of a g-element)<br> arbitrary scaling factor (of a window)</font></blockquote>
<p>
 For most purposes, we should just use the standard zooming track. The main use for the parameterized zooming preset is to allow us to set the x-scaling and y-scaling factors of a g-element separately; this works only when the &quot;asymmetrical scaling&quot; use option is set (see docs for Glimmr Canvas-Based Drawing).
<p>
 To invoke a parameterized zooming track:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a parameterized zooming animation targeting &lt;chosen parameter/property&gt; of &lt;target&gt; and ending at &lt;final scaling factor&gt; at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;cycling&gt;</font></blockquote>
<p>
 Usage example:
<p>
 Animating the scaling of only the y-axis to &quot;compress&quot; a sprite visually. Making the sprite right-aligned causes it to be anchored at the bottom:<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> Use asymmetrical scaling.</font></blockquote>
<p>
<blockquote><font color="#000080"> The squishy track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Ball is a sprite. It is right-aligned. The image-ID is Figure of Ball.</font></blockquote>
<p>
<blockquote><font color="#000080"> To squish the blob:<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the squishy track as a parameterized zooming animation targeting the y-scaling factor of the Blob and ending at 0.1000 at 24 fps with a duration of 4 frames.</font></blockquote>
<p>
 Easing equations can be applied to a parameterized zooming track just as they can a standard zooming track.
<p>
 Chapter: Custom animations
<p>
 It is also possible to create entirely custom animations, using the &quot;custom&quot; preset. The built-in phrase for custom presets addresses only the interval, duration, and modality (i.e., cycling or randomized) of the track. It does not allow for the specification of a target object, largely because there is no assumption that the &quot;animation&quot; produced will be graphical in nature. Custom tracks can be used for any effect that can be thought of in terms of recurring frames, and in fact it is assumed that custom tracks will most likely be used for real-time events that don't involve graphical displays.
<p>
 To invoke a custom animation, we can use this phrase:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a custom animation at &lt;interval&gt; with a duration of &lt;length&gt; frames, &lt;randomized&gt;&lt;cycling&gt;</font></blockquote>
<p>
 Or, without specifying a duration:
<p>
<blockquote><font color="#000080"> animate &lt;track&gt; as a custom animation at &lt;interval&gt;, &lt;randomized&gt;&lt;cycling&gt;</font></blockquote>
<p>
 Note that the latter will have a duration of 1 frame by default unless we specify it some other way.
<p>
 On its own, our &quot;animate...&quot; phrase will do nothing. We also need to write an animation rule to implement the animation itself. Note that while cycling behavior will be implemented automatically, we would need to write our own randomization logic into our animation rule for the &quot;randomized&quot; option to have any effect (in the vast majority of cases, we will just ignore that option).
<p>
 The animation rule belongs to the &quot;animation&quot; rulebook, and is parameterized on the animation track to be animated. In other words, if we have defined a custom animation track called &quot;my anim-track&quot;, then we would write our animation rule's preamble like this:
<p>
<blockquote><font color="#000080"> Animation rule for my anim-track:</font></blockquote>
<p>
 (As with any other rule, of course, we can also attach conditions to the preamble, e.g. &quot;An animation rule for my anim-track when the player carries the gun&quot;, or specify &quot;first animation rule...&quot; or &quot;last animation rule...&quot; to influence the rulebook ordering.)
<p>
 GCA provides only one rule intended for custom tracks: the &quot;minimal custom animation rule&quot;, which serves only to print a simple message to the debugging log. We can delist it if we want to provide our own debugging log print statements (see the extension's source code for examples).
<p>
 We can use the phrase &quot;cease animating &lt;track&gt;&quot; to stop our custom track or any other. This will halt the animation immediately and fire its animation-callback, and is useful both for cycling animations and for those which we need to end early for some reason. A quick usage example:
<p>
<blockquote><font color="#000080"> Animation rule for my anim-track:<br>&nbsp;&nbsp;&nbsp;&nbsp; if the player wears the girdle:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cease animating my anim-track.</font></blockquote>
<p>
 Section: Usage examples
<p>
 Here are a couple of examples of custom animation rules, and the code needed to set them up.
<p>
 This code produces a timer that counts the seconds in the status bar.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The timer display is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> Seconds elapsed is a number variable.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; now the right hand status line is &quot;s: [seconds elapsed]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the timer display as a custom animation at 1 frame per second, cycling.</font></blockquote>
<p>
<blockquote><font color="#000080"> Animation rule for the timer display:<br>&nbsp;&nbsp;&nbsp;&nbsp; increase the seconds elapsed by 1;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the right hand status line is &quot;s: [seconds elapsed]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; update the status line;<br>&nbsp;&nbsp;&nbsp;&nbsp; advance the timer display.</font></blockquote>
<p>
<blockquote><font color="#000080"> To update the/-- status line:<br>&nbsp;&nbsp;&nbsp;&nbsp; (-  if (gg_statuswin) DrawStatusLine();  -)</font></blockquote>
<p>
 This code simply counts down (silently) to a desired real-time event.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The countdown is an animation track.<br> The animation-callback of the countdown is &quot;Kablooie!&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;The bomb will go off in 180 seconds.&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the countdown as a custom animation at 1 frame per second with a duration of 180 frames.</font></blockquote>
<p>
<blockquote><font color="#000080"> Animation rule for the countdown:<br>&nbsp;&nbsp;&nbsp;&nbsp; advance countdown.</font></blockquote>
<p>
 Section: Important note about animations that print text
<p>
 It is illegal to print text to a window if that window is awaiting input from the player, though some interpreters will allow it. In the vast majority of games, this means that we should not use an animation rule to print text to the main window unless we invoke the &quot;delay input until all animations are complete&quot; phrase. Other text windows, including the status line, will not cause any problem unless we are also requesting input in those windows.
<p>
 (Note that the animation debugging provided by this extension is subject to the same rules. If we are not using the Glimmr Debugging Console extension or another alternate stream for the output from the debugger, it will only print in some interpreters. Conveniently, both the OS X and Windows IDEs allow such illegally printed text; Gargoyle, however, does not. See the section on Debugging below for more on redirecting the debugging log to alternate streams.)
<p>
 Section: Adding easing to a custom animation
<p>
 If we want to add easing (see section on Easing below) to a custom animation rule, we must pass the appropriate parameters into the track's easing equation using this construction:
<p>
<blockquote><font color="#000080"> the easing of &lt;track&gt; applied to the &lt;current frame&gt; and &lt;duration&gt; and &lt;starting value&gt; and &lt;difference between starting and ending value&gt;</font></blockquote>
<p>
 For example, to calculate the current position on a scale of 1 to 100 in a cycling animation according to some easing equation, we would do something this:
<p>
<blockquote><font color="#000080"> let cyclic-frame be current-frame of my anim-track - (cycles completed of my anim-track * cycle-length of my anim-track);<br> let x be the easing of my anim-track applied to the cyclic-frame and the cycle-length of my anim-track and 1 and 99;</font></blockquote>
<p>
 Chapter: Easing (Tweening)
<p>
 The term &quot;easing&quot; refers to motions in which the acceleration changes over time. The term may seem strange, but think of it in terms of easing into a chair-your body moves more slowly as you approach the cushion. Easing equations can imitate this sort of gradual slowing as the motion reaches the endpoint, and they can also do much more, such as imitate the bouncing of a ball, or overshoot the endpoint and snap back.
<p>
 Easing is closely related to the concept of &quot;tweening&quot;. Briefly, tweening is short for &quot;in-betweening&quot;. In traditional animation, animations were organized around key frames--the critical points in any sequence. These keyframes were drawn first, and then the &quot;betweens&quot; were filled in to connect those key moments smoothly; because they were less critical, they were often filled in by the lower ranks of the animation team. In computer animation, keyframes are defined by the user, and the tweening is done automatically by the software.
<p>
 Glimmr Canvas Animation (GCA) is no different, though it doesn't really use the concept of the keyframe. Where programs like Flash have a master timeline punctuated by user-defined keyframes, each GCA animation track can be thought of as a self-contained timeline separating two keyframes-the starting and ending points of that particular motion or effect. GCA builds sophisticated and customizable tweening into nearly all of the preset animation types via the use of &quot;easing&quot; equations that interpolate movement between the starting and ending points.
<p>
 The most common use of easing is in moving objects across the screen, but easing equations can be used on any continuous field of values, not just coordinates in space. For example, when used on a zooming track: instead of proceeding from 50% of actual size to 100% by equal intervals, the zoom might be &quot;eased&quot; using a cubic ease-out equation so that the size change starts out rapid, increases slightly in speed for the first 1/2 or so of the duration, and then slows comparatively quickly. (For just such an effect, see the Maps of Murder example included with this extension.)
<p>
 The best way to start exploring the effects that easing can have on your animations is probably to try out the &quot;Eased Movements&quot; example included with this extension. You might also want to check out these online resources:
<p>
<blockquote><font color="#000080"> http://glimmr.wordpress.com/2011/06/11/animation-demo-series-2/<br> http://en.wikipedia.org/wiki/Tweening<br> http://www.actionscript.org/forums/showthread.php3? t=5312<br> http://www.gizma.com/easing/<br> http://timotheegroleau.com/Flash/experiments/easing_function_generator.htm<br> http://snippets.dzone.com/posts/show/4005<br> http://jqueryui.com/demos/effect/easing.html</font></blockquote>
<p>
 Section: Types of easing
<p>
 GCA has 16 easing equations built in, from purely linear to a quadratic curve to a parabolic bounce. If these don't meet your needs, you can also add your own equations (see below for a few notes on rolling your own).
<p>
 Most of the included equations are available in three flavors each. &quot;Easing out&quot; describes a sequence in which motion starts out moving rapidly and then slows, more or less gradually, to a stop. &quot;Easing in&quot; is the opposite--slow to fast. &quot;Easing in-out&quot; combines the two effects. Different functions are used to qualify these three basic categories, resulting in the full names of the easing equations: &quot;quadratic easing in&quot; for example, or &quot;circular easing out&quot;.
<p>
 Here are the names of the built-in equations:
<p>
<blockquote><font color="#000080"> linear easing (constant speed-the default, not really &quot;eased&quot; at all)</font></blockquote>
<p>
<blockquote><font color="#000080"> quadratic easing in<br> quadratic easing out<br> quadratic easing in-out</font></blockquote>
<p>
<blockquote><font color="#000080"> cubic easing in<br> cubic easing out<br> cubic easing in-out</font></blockquote>
<p>
<blockquote><font color="#000080"> circular easing in<br> circular easing out<br> circular easing in-out</font></blockquote>
<p>
<blockquote><font color="#000080"> cubic back easing in<br> cubic back easing out<br> cubic back easing in-out</font></blockquote>
<p>
<blockquote><font color="#000080"> bounce easing in<br> bounce easing out<br> bounce easing in-out</font></blockquote>
<p>
 Again, see the &quot;Eased Movements&quot; example included with the extension to preview each of these effects.
<p>
 Section: Assigning easing to animation tracks
<p>
 Assigning an easing equation to an animation track is simple. An animation track has a property called the &quot;easing&quot;, and we simply assign the appropriate easing function to this property, e.g.:
<p>
<blockquote><font color="#000080"> the easing of the default track is the bounce easing in rule</font></blockquote>
<p>
 If we don't specify an easing, then the default &quot;linear easing&quot; rule will be used. This rule does not involve any speed variations; it provides a simple linear interpolation of values.
<p>
 Note that motion and parameterized motion tracks (but no others) can also utilize a &quot;secondary easing&quot;. If a secondary easing function is applied, then this function will apply only to the y-axis, while the primary easing function will be used for the x-axis:
<p>
<blockquote><font color="#000080"> The easing of the complex movement track is the cubic easing in rule.<br> The secondary easing of the complex movement track is the circular easing out rule.</font></blockquote>
<p>
 If we want to reset the secondary easing, we can do that by specifying &quot;null easing&quot;. These phrases would return our track to its initial state:
<p>
<blockquote><font color="#000080"> now the easing of the complex movement track is the linear easing rule;<br> now the secondary easing of the complex movement track is the null easing rule.</font></blockquote>
<p>
 Section: Implementation details
<p>
 Every easing equation utilizes four parameters, conventionally known as &quot;t&quot;, &quot;d&quot;, &quot;b&quot;, and &quot;c&quot;:
<p>
<blockquote><font color="#000080"> t - time, the current frame of the animation.<br> d - duration, the length in frames of the animation.<br> b - initial value of the property being animated; that is, the value at a &quot;t&quot; of 0.<br> c - change, the difference between the ending value of the property being animated and the initial value (i.e., &quot;b&quot;).</font></blockquote>
<p>
 The values for &quot;t&quot; and &quot;d&quot; are calculated as needed (generally equivalent to the current-frame and the animation-length properties of the track), but the &quot;b&quot; and &quot;c&quot; are are initialized when the &quot;animate...&quot; phrase is invoked, and are stored in the following properties of the animation track itself:
<p>
<blockquote><font color="#000080"> start-x (&quot;b&quot;) - The initial value or x-coordinate of the object being animated. In the case of a zooming animation, this number is an integer representation of the scaling factor (the latter multiplied by 10,000).<br> start-y (&quot;b&quot;) - In the case of a motion animation or a zooming animation when we are scaling on both axes independently, we may also store the initial value or y-coordinate of the object being animated, for use in the secondary easing equation.<br> delta-x (&quot;c&quot;) - The difference between the ending value that we provide in the &quot;animate&quot; phrase and the starting value stored in start-x (i.e., the &quot;b&quot; parameter).<br> delta-y (&quot;c&quot;) - If we are using a secondary easing equation, the difference between the ending value that we provide in the &quot;animate&quot; phrase and the starting value stored in start-y (i.e., the &quot;b&quot; parameter).</font></blockquote>
<p>
 Section: Adding custom easing equations
<p>
 Adding new easing equations is both easy and difficult. It is easy in that there's not much to the mechanics of the process. We simply define a &quot;to decide&quot; phrase using a certain rigid form for the preamble. Here is the preamble for one of the phrases included with GCA. We would copy this preamble exactly, replacing the capitalized phrase with the name of our equation:
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> To decide what number is QUADRATIC EASING IN for time (t - a number) duration (d - a number) beginning (b - a number) change (c - a number) (this is the QUADRATIC EASING IN rule):</font></blockquote>
<p>
 Now on to what's hard about writing new equations. First, coming up with them in the first place. GCA borrows equations from various places around the web (see the resources listed above and in the comments to the extension's source code). There are certainly other equations out there, and the easiest thing will be to borrow those.
<p>
 The next difficult thing is dealing with Inform's limited math capabilities. Inform does not follow the standard rules for precedence in mathematical operations, so we need to be very liberal in using parentheses to spell out for Inform which operations should be grouped together.
<p>
 Here's an example of a relatively simple equation from those included with GCA:
<p>
<blockquote><font color="#000080"> To decide what number is QUADRATIC EASING IN for time (t - a number) duration (d - a number) beginning (b - a number) change (c - a number) (this is the QUADRATIC EASING IN rule):<br>&nbsp;&nbsp;&nbsp;&nbsp; let t1 be (t plus 0.0) / d;<br>&nbsp;&nbsp;&nbsp;&nbsp; decide on (c * t1 * t1) + b to the nearest whole number.</font></blockquote>
<p>
 Once we've completed our equation, we can refer to it just as if it were one of the built-in equations; no additional steps are needed:
<p>
<blockquote><font color="#000080"> My anim-track is an animation track. The easing is the polysyllabic easing out rule.</font></blockquote>
<p>
 Chapter: Debugging
<p>
 Because the standard Glimmr debugging log already generates a lot of debugging output, Glimmr Canvas Animation uses a separate debugging option. To enable the log messages from GCA, enable this use option:
<p>
<blockquote><font color="#000080"> Use animation debugging.</font></blockquote>
<p>
 This can be used alongside standard Glimmr debugging (&quot;Use Glimmr debugging&quot;), though the output will likely be overwhelming.
<p>
 By default, the animation log is written to the main window. However, unless we are using the &quot;delay input until all animations are complete&quot;, we may not see the output in the main window, particularly the per-frame animation debugging messages. This is because in Glk/Glulx, it is illegal to print text to a window if that window is awaiting input from the player. Some interpreters, including those in the Mac and Windows IDEs, will allow this illegal printing. Others, such as Gargoyle, do not. To be sure that we are seeing debugging log output, we may want to do one of the following:
<p>
<blockquote><font color="#000080"> 1) Include the Glimmr Debugging Console extension, to segregate Glimmr logging output into its own window.</font></blockquote>
<p>
<blockquote><font color="#000080"> 2) We can set up our own alternate text-buffer window and direct log output there by setting the &quot;console output window&quot; variable, e.g.:</font></blockquote>
<p>
<blockquote><font color="#000080"> The console output window is my-text-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> 3) We can also send console log output to the transcript, while not printing it anywhere else. To do this, we include this code in our story file:</font></blockquote>
<p>
<blockquote><font color="#000080"> To say &gt;console:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say echo stream of main-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> To say &lt;:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say stream of main-window;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say run paragraph on.</font></blockquote>
<p>
<blockquote><font color="#000080"> This will only work when a transcript is actually being written. To ensure that we do not forget to initiate one, we can include this:</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try switching the story transcript on.</font></blockquote>
<p>
 Chapter: Performance Tips
<p>
<blockquote><font color="#000080"> 1. Test outside of the IDE. Games played within the Inform IDE will be slower than games played in an external interpreter. The Mac IDE may sometimes show minor scaling artifacts that are not seen with external interpreters. Try pressing the Release button to produce a blorb file, and play that file in the latest version of a fast, modern interpreter.</font></blockquote>
<p>
<blockquote><font color="#000080"> 2. Bes sure to test in all of the interpreters that you expect your players to use.</font></blockquote>
<p>
<blockquote><font color="#000080"> 3. Be sure that your images are not too large. Images should be sized no larger than you want them to appear onscreen.</font></blockquote>
<p>
<blockquote><font color="#000080"> 4. Interpreters will vary in their ability to scale large images rapidly. Zoom handles this scaling quite well, but most other interpreters are not very good. While Gargoyle is actually faster than Zoom at most graphics operations, its performance at scaling large images is middling; it is the best alternative to Zoom, but is nowhere near as fast.</font></blockquote>
<p>
<blockquote><font color="#000080"> 5. If you have multiple graphics windows, only some of which have animations, change or preempt the &quot;animation window-updating rule&quot; to be more selective. This rule redraws *all* of the open graphics windows for each frame of an animation; we should rewrite it to update only the windows that we are animating.</font></blockquote>
<p>
<blockquote><font color="#000080"> 6. If you have multiple animations running at once, see whether you get better performance by running them at the same rate. If you have animations running at different rates, make one a (preferably low) multiple of the other, e.g. 100 ms per frame and 200 ms per frame. This will mean fewer timer ticks where nothing meaningful takes place.</font></blockquote>
<p>
 Chapter: Contact info
<p>
 This extension is released under the Creative Commons Attribution licence. Bug reports, feature requests or questions should be made at &lt;https:/github.com/i7/extensions/issues&gt;.
<p>
 For questions about Glimmr, please consider posting to either the rec.arts.int-fiction newsgroup or at the intfiction forum (http://www.intfiction.org/forum/). This allows questions to be public, where the answers can also benefit others.
<p>
 Chapter: Change Log
<p>
 Version 2: Updated for 6M62 by Dannii Willis
<p>
 Version 1: Initial release.
<p>
 Example: * Animation Rule Variations - This simple example shows how we can vary preset animations by adding rules to the animation rulebook. We'll have four variations on a simple horizontal motion animation. The &quot;player&quot; can choose from among these variation via a keypress menu. The chosen animation will play immediately, and once it finishes s/he will have a chance to choose another.
<p>
 We start with basic setup, creating a graphics window, a canvas, and some stuff to animate. This is primarily a round ball, implemented as a bitmap element so that we can avoid loading any external images. There are also two non-animated point primitives, to mark the beginning and end points of the ideal path of movement; these will primarily help us to see the differences between variations 2 and 3.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> &quot;Animation Rule Variations&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Include Glimmr Canvas Animation by Erik Temple.</font></blockquote>
<p>
<blockquote><font color="#000080"> There is a room.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-window is a graphics g-window spawned by the main-window. The position of the graphics-window is g-placeabove. The measurement of the graphics-window is 50. The back-colour of the graphics-window is g-black.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-window canvas is a g-canvas. The canvas-width is 500. The canvas-height is 300. The associated canvas of the graphics-window is the graphics-window canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; open up the graphics-window;</font></blockquote>
<p>
<blockquote><font color="#000080"> The associated canvas of a g-element is the graphics-window canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Ball is a monochrome bitmap. The tint is g-White. The Ball is center-aligned. The bitmap-array is {<br>&nbsp;&nbsp;&nbsp;&nbsp; { 0, 0, 1, 1, 1, 0, 0 },<br>&nbsp;&nbsp;&nbsp;&nbsp; { 0, 1, 0, 0, 0, 1, 0 },<br>&nbsp;&nbsp;&nbsp;&nbsp; { 1, 0, 0, 0, 0, 0, 1 },<br>&nbsp;&nbsp;&nbsp;&nbsp; { 1, 0, 0, 0, 0, 0, 1 },<br>&nbsp;&nbsp;&nbsp;&nbsp; { 1, 0, 0, 0, 0, 0, 1 },<br>&nbsp;&nbsp;&nbsp;&nbsp; { 0, 1, 0, 0, 0, 1, 0 },<br>&nbsp;&nbsp;&nbsp;&nbsp; { 0, 0, 1, 1, 1, 0, 0 } }.</font></blockquote>
<p>
<blockquote><font color="#000080"> Initial-position indicator is a point primitive. The tint is g-red. The display-layer is 2.<br> Secondary-position indicator is a point primitive. The tint is g-red. The display-layer is 2.</font></blockquote>
<p>
 Next, we define our animation track, and assign a few global variables to control the animation. (We use the globals so that we need only make changes in one place should we want to tweak things.)
<p>
 The after printing the banner text rule contains the entire flow of the &quot;game&quot;: we enter a loop in which it is only possible for the player to press a number keyed to the menu, or to press &quot;q&quot; to quit. We store the number pressed in the &quot;key-option&quot; variable; we will use it later to decide which subsidiary animation rule to call. Then we invoke the animate phrase that will move the ball from its current position to the destination coordinates. We prevent the game from accepting any input until the animation completes by using the &quot;delay input until all animations are complete&quot; phrase. And after the animation completes, we swap the coordinates stored in the destination variable, so that the next animation will move the ball back where it came from.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The movement track is an animation track.</font></blockquote>
<p>
<blockquote><font color="#000080"> The motion-duration is a number variable. The motion-duration is 20.<br> Base rate is a number variable. Base rate is 40.<br> Rate interval is a number variable. Rate interval is 10.</font></blockquote>
<p>
<blockquote><font color="#000080"> Initial position is a list of numbers variable. Initial position is { 10, 100 }.<br> Secondary position is a list of numbers variable. Secondary position is { 490, 100 }.<br> Destination is a list of numbers variable.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; now the origin of the ball is the initial position;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the origin of the initial-position indicator is the initial position;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the origin of the secondary-position indicator is the secondary position.</font></blockquote>
<p>
<blockquote><font color="#000080"> Key-option is a number variable.</font></blockquote>
<p>
<blockquote><font color="#000080"> After printing the banner text:<br>&nbsp;&nbsp;&nbsp;&nbsp; now the destination is the secondary position;<br>&nbsp;&nbsp;&nbsp;&nbsp; say paragraph break;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;This demo shows some ways in which a simple animation can be changed using additional animation rules. Type a number to see the corresponding animation:[paragraph break]1. Simple motion along a path.[line break]2. Random noise added to a path[line break]3. Random noise added to a path, but nevertheless arriving at the originally specified ending point[line break]4. Gradual decrease in the frame rate.[paragraph break]Press Q to quit.[paragraph break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; while true is true:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now key-option is the character code entered in the main-window minus 48;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if key-option is 65, break;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if key-option is less than 1 or key-option is greater than 4, next;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; animate the movement track as a motion animation targeting the Ball and ending at the destination at (base rate) ms per frame with a duration of (motion-duration) frames;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay input until all animations are complete;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if the destination is the initial position:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the destination is the secondary position;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the destination is the initial position;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;** User exited demonstration **&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; follow the immediately quit rule.</font></blockquote>
<p>
 The &quot;key-option&quot; variable, which contains the number of the menu that the player selected, is now used to decide which subsidiary animation to use. We don't need to run a second rule if the player pressed 1, since that corresponds to the unadorned movement invoked by the &quot;animate...&quot; phrase. The subsidiary rules run *after* the built-in preset animation rule, so they tweak the outcomes of that rule. (If we wanted our animation rules to run before the preset rule, we could make them &quot;first&quot; rules.)
<p>
 Option 2 randomly deforms the basic path of motion, and requires only a very simple rule that adds or subtracts a number between 1 and 10 from the x and y coordinates of the ball's origin. The &quot;adjust the origin...&quot; phrase used here is an easter egg phrase provided by GCA; we can also use &quot;adjust the endpoint&quot; for primitive elements. Note that this option will almost never finish on the destination coordinate specified, since we are adding noise to the chosen coordinate all the way along.
<p>
 Option 3 uses the same deformation as Option 2, but with a twist. We want to end on the originally specified destination point. This is tricky, because motion animations are completely relative: when the animation is set, up GCA calculates what we'll have to do to get to the destination, but doesn't save any information about the destination itself. To keep our eyes on the prize, then, we need to reconstruct the original destination coordinate, and reorient ourselves to it, every frame. This will cause the deformation to be a bit smoother than in Option 2, but still noticeable. Note that we only apply deformations for the first 3/4 of the animation's running time. That's so that we don't jump too unnaturally to the destination at the end if we are far off.
<p>
 Option 4 actually changes the rate of the animation itself. Once we're about 1/3 of the way through the allotted frames, the rule kicks in to change the rate of the timer tick, increasing the time between ticks and therefore slowing the apparent speed of the animation. For a motion animation, this is probably better done with an easing equation, but this kind of speed control might work nicely for a reel animation.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> Animation rule for the movement track when key-option is 2:<br>&nbsp;&nbsp;&nbsp;&nbsp; adjust the origin of (the animation-target of the movement track) by (a random number between -10 and 10) and (a random number between -10 and 10).</font></blockquote>
<p>
<blockquote><font color="#000080"> Animation rule for the movement track when key-option is 3:<br>&nbsp;&nbsp;&nbsp;&nbsp; if current-frame of the movement track is less than (3 * (motion-duration / 4)):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let end-x be start-x of the movement track plus delta-x of the movement track;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let end-y be start-y of the movement track plus delta-y of the movement track;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let X be a random number between -10 and 10;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let Y be a random number between -10 and 10;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; adjust the origin of (the animation-target of the movement track) by (X) and (Y);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the start-x of the movement track is entry 1 of the origin of the animation-target of the movement track;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the start-y of the movement track is entry 2 of the origin of the animation-target of the movement track;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now delta-x of the movement track is end-x minus start-x of the movement track;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now delta-y of the movement track is end-y minus start-y of the movement track.</font></blockquote>
<p>
<blockquote><font color="#000080"> Animation rule for the movement track when key-option is 4:<br>&nbsp;&nbsp;&nbsp;&nbsp; if current-frame of the movement track is greater than (motion-duration / 3):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let rate be (base rate) + ((current-frame of the movement track - (motion-duration / 3)) * (rate interval));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time the movement track at (rate) ms per frame.</font></blockquote>
<p>
 Example: * Maps of Murder - The user interface is an ideal place to experiment with animation effects. Here, we sketch a kind of image browser for an IF game. Four thumbnail versions (the map illustrations from Dell Map-Back murder mysteries) are displayed in a grid. We can click on any one of them to maximize it; we use two animation tracks to animate the maximization, scaling the image to full size while moving it to the center of the window. Click on the cover again to return it to the original thumbnail size and location.
<p>
 This example illustrates the &quot;stacking&quot; of animation tracks to achieve more complex effects; in this case we are stacking motion and scaling animations, with an easing effect lending a subtle arc to things. The example also demonstrates how we can test the animation state of an object so as to modify behavior appropriately, and more generally it shows how to write generalized code-we could add 20 more covers without changing any of the core code.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> &quot;Maps of Murder&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Include Glimmr Graphic Hyperlinks by Erik Temple.<br> Include Glimmr Canvas Animation by Erik Temple.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-window is a graphics g-window spawned by the main-window. The position of the graphics-window is g-placeright. The measurement of the graphics-window is 50. The back-colour of the graphics-window is g-black. The graphics-window is g-graphlinked.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-canvas is a g-canvas. The canvas-width is 462. The canvas-height is 652. The associated canvas of the graphics-window is the graphics-canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; open up the graphics-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> There is a room.</font></blockquote>
<p>
<blockquote><font color="#000080"> Figure of Whos Calling is the file &quot;WhosCalling.png&quot;.<br> Figure of Feathered Serpent is the file &quot;FeatheredSerpent.png&quot;.<br> Figure of Hidden Ways is the file &quot;HiddenWays.png&quot;.<br> Figure of Mourned Sunday is the file &quot;MournedOnSunday.png&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Figure of Transparent Overlay is the file &quot;Overlay.png&quot;.</font></blockquote>
<p>
 We create a new kind of sprite, the &quot;cover-image&quot;, and give it a new coordinate property, the &quot;rightful position&quot;. This is the position to which the cover should return after it has been maximized. Note that we are showing the covers at half size initially; they will be shown at full size on maximization.
<p>
 When a cover has been maximized, we place a semi-transparent overlay over the other images so that they don't distract from the player's view of the enlarged sprite. (This overlay is itself a sprite.) The grid of covers is on display layer 1. The overlay, when it appears, will be drawn on layer 2, and the cover, when it is maximized is shown on layer 4. Layer 3 is used for sprites that are in the process of minimization.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> A cover-image is a kind of sprite. A cover-image is center-aligned. Some cover-images are defined by the Table of Covers.</font></blockquote>
<p>
<blockquote><font color="#000080"> The associated canvas of a g-element is usually the graphics-canvas. The graphlink status of a cover-image is usually g-active. A cover-image is publically-named.</font></blockquote>
<p>
<blockquote><font color="#000080"> A cover-image has a list of numbers called the rightful position.</font></blockquote>
<p>
<blockquote><font color="#000080"> The linked replacement-command of a cover-image is usually &quot;Toggle [the current graphlink]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Table of Covers</font><br><table border="0" cellspacing="0" cellpadding="0"><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> cover-image</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> image-ID</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> origin</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> the first cover</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Whos Calling</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 126, 173 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> the second cover</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Feathered Serpent</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 337, 173 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> the third cover</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Hidden Ways</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 126, 479 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> the fourth cover</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Mourned Sunday</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 337, 479 }</font></font></td></tr></table></blockquote>
<p>
<blockquote><font color="#000080"> The transparent overlay is a sprite. The image-ID is Figure of Transparent Overlay. The origin is { 0, 0 }. The display status is g-inactive. The display-layer is 2.</font></blockquote>
<p>
<blockquote><font color="#000080"> A cover-image can be maximized.</font></blockquote>
<p>
 We define four tracks. Why four? It will be possible to click on another cover to maximize it while we have another cover already enlarged; we have four tracks so that both can move at the same time (using two tracks each). The primary tracks maximize, while the secondary tracks minimize the cover back to the grid.
<p>
 Note that the primary zooming track has an easing equation (cubic easing out) applied. Combined with the motion, this creates a rather subtle to the overall motion of maximization. We don't apply the easing to the secondary track-it's a bit too distracting for the return journey, which is after all about minimization.
<p>
 Also note the callback on the secondary zooming track. This moves the cover back to display layer 1 once it has finished moving back to its original position in the grid. By waiting until the end to move it to layer 1, we avoid seeing it move behind the semitransparent overlay. This is the last stage in a series of layer manipulations; see the carry out toggling rule below for the other layering logic.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The primary zooming track, the primary motion track, the secondary zooming track, the secondary motion track are animation tracks.</font></blockquote>
<p>
<blockquote><font color="#000080"> The animation-callback of the secondary zooming track is &quot;[@ now the display-layer of the animation-target of the secondary zooming track is 1]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> The easing of the primary zooming track is the cubic easing out rule.</font></blockquote>
<p>
<blockquote><font color="#000080"> The resting scaling ratio is a real number variable. The resting scaling ratio is 0.5000.<br> The display scaling ratio is a real number variable. The display scaling ratio is 1.000.<br> The display position is a list of numbers variable. The display position is { 231, 326 }.</font></blockquote>
<p>
 All of the animation action takes place in the carry out toggling rule. We first check to see whether the secondary zooming track is active; if it is, that means that the sprite that was clicked on was already returning to the original grid position, and we need to deactivate that animation so that we can maximize it again (later on in the same rule).
<p>
 Next we check to see whether there is already an image in the central position. If so, we need to start reducing it. We change its display layer so that it is above the semitransparent overlay, but below whichever sprite is actually the target of the player's click (which will be the noun supplied to the toggling action), then we animate it using the secondary tracks to return it to its original position and size. If this happens to be the image that we clicked on, we stop the action-we don't need to do any more, since clicking on an maximized image just toggles it back to the grid.
<p>
 Finally, we deal with the case in which a small sprite is clicked on. We first move it to the uppermost layer so it overlays everything else, then we activate the semitransparent overlay and animate the primary tracks to maximize the sprite that was clicked.
<p>
 All this may seem a bit complex. It does requiring some planning, and it especially helps to work out the layers you need in advance, but you will also undoubtedly also end up tweaking things as you test your original design.
<p>
 Note that the implementation of this as a standard action, particularly with the superfluous textual reports on what's been maximized and what's been minimized, is probably a poor design choice!
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> Toggling something is an action applying to one visible thing. Understand &quot;toggle [any thing]&quot; as toggling something.</font></blockquote>
<p>
<blockquote><font color="#000080"> Carry out toggling something:<br>&nbsp;&nbsp;&nbsp;&nbsp; if the animation-flag of the secondary zooming track is g-active:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deactivate the secondary zooming track;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deactivate the secondary motion track;<br>&nbsp;&nbsp;&nbsp;&nbsp; if there is a maximized cover-image:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let item be a random maximized cover-image;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now item is not maximized;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the display-layer of item is 3;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; animate the secondary zooming track as a zooming animation targeting the item and ending at the resting scaling ratio at 24 fps with duration of 8 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; animate the secondary motion track as a motion animation targeting the item and ending at the rightful position of the item at 24 fps with duration of 6 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the display status of the transparent overlay is g-inactive;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if item is the noun, stop the action;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the display-layer of the noun is 4;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the noun is maximized;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the display status of the transparent overlay is g-active;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the primary zooming track as a zooming animation targeting the noun and ending at the display scaling ratio at 24 fps with duration of 8 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the primary motion track as a motion animation targeting the noun and ending at the display position at 24 fps with duration of 6 frames.</font></blockquote>
<p>
<blockquote><font color="#000080"> Report toggling something:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[The noun] has been [if the noun is maximized]maximized[otherwise]minimized[end if].&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;This example demonstrates the use of multiple 'tracks' to provide complex animation effects. Click on an image to zoom in and move it to the center. Click again to toggle. You can also click on a second cover while the first is zoomed; both will animate smoothly into the appropriate positions.[paragraph break]The images are the back covers of Dell Map-Back mystery books. The Map-Back was a prototype of and possibly a direct influence on the 'feelies' that accompanied classic Infocom games such as [i]Deadline[/i]. These images are from Marble River's Ephemera; you can see the front covers at http://marbleriver.blogspot.com/2010/01/backs-dell-more-map.html.&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; repeat with item running through cover-images:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the rightful position of the item is the origin of the item;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the scaling factor of the item is the resting scaling ratio.</font></blockquote>
<p>
 Example: * Eased Movements - This example is primarily a demo of the available easing equations. The animation itself is handled in only a single line, whereas most of the code is devoted to user input, particularly the selection of primary and secondary easing via hyperlinks. The example does however illustrate the use of a number of features that are rarely demoed and which may be of interest to those interested in animation, including mouse input and hyperlink input.
<p>
 There is only a single animation track, the movement track. We initialize both its primary and secondary easing to &quot;linear easing&quot; (i.e., default movement, no real easing to speak of).
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> &quot;Eased Movements&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Include Glimmr Graphic Hyperlinks by Erik Temple.<br> Include Glimmr Canvas Animation by Erik Temple.</font></blockquote>
<p>
<blockquote><font color="#000080"> Use no status line.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-window is a graphics g-window spawned by the main-window. The position of the graphics-window is g-placeright. The measurement of the graphics-window is 80. The back-colour of the graphics-window is g-black. The graphics-window is g-graphlinked.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-canvas is a g-canvas. The canvas-width is 200. The canvas-height is 200. The associated canvas of the graphics-window is the graphics-canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> The secondary-window is a text-buffer g-window spawned by the graphics-window. The measurement is 25. The position is g-placeright. The back-colour is g-white. The back-colour of the main-window is g-white.</font></blockquote>
<p>
<blockquote><font color="#000080"> The movement track is an animation track. The secondary easing is the linear easing rule.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; try requesting the story file version;<br>&nbsp;&nbsp;&nbsp;&nbsp; say run paragraph on;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[i]The equation illustrations are borrowed from http://jqueryui.com/demos/effect/easing.html[/i][line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[paragraph break][instruction text]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; wait for any key in the main-window;<br>&nbsp;&nbsp;&nbsp;&nbsp; open up the graphics-window;<br>&nbsp;&nbsp;&nbsp;&nbsp; open up the secondary-window;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the column-break is the number of rows in the Table of Glulx Hyperlink Replacement Commands;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;Break: [column-break].&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; now selected secondary easing is (column-break + 1);<br>&nbsp;&nbsp;&nbsp;&nbsp; follow the hyperlink listing rule;<br>&nbsp;&nbsp;&nbsp;&nbsp; while 1 is 1:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wait for any key in the main-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> Figure of Ball is the file &quot;Ball.png&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Figure of BackEaseIn is the file &quot;BackEaseIn.png&quot;.<br> Figure of BackEaseInOut is the file &quot;BackEaseInOut.png&quot;.<br> Figure of BackEaseOut is the file &quot;BackEaseOut.png&quot;.<br> Figure of BounceEaseIn is the file &quot;BounceEaseIn.png&quot;.<br> Figure of BounceEaseInOut is the file &quot;BounceEaseInOut.png&quot;.<br> Figure of BounceEaseOut is the file &quot;BounceEaseOut.png&quot;.<br> Figure of CircularEaseIn is the file &quot;CircularEaseIn.png&quot;.<br> Figure of CircularEaseInOut is the file &quot;CircularEaseInOut.png&quot;.<br> Figure of CircularEaseOut is the file &quot;CircularEaseOut.png&quot;.<br> Figure of CubicEaseIn is the file &quot;CubicEaseIn.png&quot;.<br> Figure of CubicEaseInOut is the file &quot;CubicEaseInOut.png&quot;.<br> Figure of CubicEaseOut is the file &quot;CubicEaseOut.png&quot;.<br> Figure of LinearEasing is the file &quot;LinearEasing.png&quot;.<br> Figure of QuadEaseIn is the file &quot;QuadEaseIn.png&quot;.<br> Figure of QuadEaseOut is the file &quot;QuadEaseInOut.png&quot;.<br> Figure of QuadEaseInOut is the file &quot;QuadEaseOut.png&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> The associated canvas of a g-element is usually the graphics-canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> The Ball is a sprite. It is center-aligned. The image-ID is Figure of Ball. The origin is { 100, 100 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> The column-break is a number variable.<br> Selected easing is a number variable. Selected easing is 1.<br> Selected secondary easing is a number variable.</font></blockquote>
<p>
<blockquote><font color="#000080"> This is the hyperlink listing rule:<br>&nbsp;&nbsp;&nbsp;&nbsp; clear main-window;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[italic type]Easing (x-axis)[roman type][paragraph break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; repeat with x running from 1 to 32:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if x is (column-break + 1):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; move focus to secondary-window, clearing the window;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[italic type]Secondary easing (y-axis)[roman type][paragraph break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if x &lt; (column-break + 1):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if x is selected easing or x is selected secondary easing:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[bold type][replacement corresponding to a link ID of x in the Table of Glulx Hyperlink Replacement Commands][roman type][line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[link x][replacement corresponding to a link ID of x in the Table of Glulx Hyperlink Replacement Commands][end link] [line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if x &gt; column-break:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if x is selected easing or x is selected secondary easing:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[bold type][replacement corresponding to a link ID of (x - column-break) in the Table of Glulx Hyperlink Replacement Commands][roman type][line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;[link x][replacement corresponding to a link ID of (x - column-break) in the Table of Glulx Hyperlink Replacement Commands][end link] [line break]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if x is column-break:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display the image corresponding to a link ID of selected easing in the Table of Glulx Hyperlink Replacement Commands;<br>&nbsp;&nbsp;&nbsp;&nbsp; display (the image corresponding to a link ID of (selected secondary easing - column-break) in the Table of Glulx Hyperlink Replacement Commands) in the secondary-window;<br>&nbsp;&nbsp;&nbsp;&nbsp; return to main screen.</font></blockquote>
<p>
<blockquote><font color="#000080"> There is a room.</font></blockquote>
<p>
<blockquote><font color="#000080"> The story headline is &quot;An interactive demonstration&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> To say instruction text:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;On the next screen, you will be able to assign easing equations to the movement of a ball.[line break]Click on one of the links in the left column to assign the easing for the x-axis of movement, and on the right to assign the easing for the y-axis.[line break]Then just click somewhere in the black part of the screen to move the ball to that point.[paragraph break]Depending on the way in which you have paired the easing equations, different effects will be generated:[paragraph break][b]1. [/b]If the easing of the two axes is the same, the ball will move in a straight line, but its acceleration will change to reflect the non-linear easing used.[line break][b]2. [/b]If linear easing on one axis is paired with nonlinear easing on the other, then requesting the ball to move diagonally will produce a motion similar to the graph shown for the nonlinear easing.[line break][b]3. [/b]If you have nonlinear easing on both axes, there will be plenty of potential for unpredictable movement, especially on the diagonal.[paragraph break]Typically, you will see more variation in the path of the ball if you request a destination diagonal from the ball's current position. Horizontally or vertically, most of the variation will tend to be in ball's acceleration patterns.[paragraph break]Maximize your window now, then [b]press any key to start experimenting![/b][paragraph break]&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> To display (F - a figure name) in (win - a g-window), one time only:<br>&nbsp;&nbsp;&nbsp;&nbsp; (-   DisplayFigureWin({win}, ResourceIDsOfFigures-&gt;{F});  -).</font></blockquote>
<p>
<blockquote><font color="#000080"> Include (-   	
		[ DisplayFigureWin win resource_ID one_time;
			if ((one_time) &amp;&amp; (ResourceUsageFlags-&gt;resource_ID)) return;
			ResourceUsageFlags-&gt;resource_ID = true; print &quot;^&quot;; glk_image_draw(win.ref_number, resource_ID, imagealign_InlineCenter, 0); print &quot;^&quot;;
		];
		 -).</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Hyperlink control (in place of Section - Selecting the replacement command in Flexible Windows by Jon Ingold)</font></blockquote>
<p>
<blockquote><font color="#000080"> Table of Glulx Hyperlink Replacement Commands</font><br><table border="0" cellspacing="0" cellpadding="0"><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> link ID</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> easement</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> replacement</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> image</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 1</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> linear easing rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;linear easing&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of LinearEasing</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 2</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> quadratic easing in rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;quadratic easing in&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of QuadEaseIn</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 3</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> quadratic easing out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;quadratic easing out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of QuadEaseOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 4</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> quadratic easing in-out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;quadratic easing in-out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of QuadEaseInOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 5</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> cubic easing in rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;cubic easing in&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of CubicEaseIn</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 6</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> cubic easing out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;cubic easing out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of CubicEaseOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 7</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> cubic easing in-out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;cubic easing in-out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of CubicEaseInOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 8</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> circular easing in rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;circular easing in&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of CircularEaseIn</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 9</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> circular easing out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;circular easing out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of CircularEaseOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 10</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> circular easing in-out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;circular easing in-out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of CircularEaseInOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 11</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> cubic back easing in rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;back easing in&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of BackEaseIn</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 12</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> cubic back easing out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;back easing out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of BackEaseOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 13</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> cubic back easing in-out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;back easing in-out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of BackEaseInOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 14</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> bounce easing in rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;bounce easing in&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of BounceEaseIn</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 15</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> bounce easing out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;bounce easing out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of BounceEaseOut</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 16</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> bounce easing in-out rule</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> &quot;bounce easing in-out&quot;</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of BounceEaseInOut</font></font></td></tr></table></blockquote>
<p>
 The following are the routines that actually implement animation. We first define some values that we can pass into the animation phrase: the initial target for the animation, the desired frame-rate, and the velocity of the ball. This isn't strictly necessary, but it can be good for flexibility.
<p>
 Next is a hyperlink processing rule, which reads any click to the text hyperlinks, translating the player's selection to an easing equation and assigning that equation as either the easing or secondary easing of the movement track.
<p>
 Finally, the &quot;clicking graphlink&quot; rule fires when the player clicks on the graphics window. It grabs the coordinates clicked and converts them to canvas coordinates; these coordinates then become the ending point for the motion animation. The motion animation itself is invoked simply by plugging this end point into the &quot;animate&quot; phrase along with the global variables describing frame rate and velocity.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> The motion target is a list of numbers variable. The motion target is { 100, 100 }.<br> Frame-rate is a number variable. Frame-rate is 24.<br> Ball-speed is a number variable. Ball-speed is 20.</font></blockquote>
<p>
<blockquote><font color="#000080"> Hyperlink processing rule:<br>&nbsp;&nbsp;&nbsp;&nbsp; let selection be the linear easing rule;<br>&nbsp;&nbsp;&nbsp;&nbsp; if the current hyperlink ID is a link ID listed in the Table of Glulx Hyperlink Replacement Commands:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let selection be easement entry;<br>&nbsp;&nbsp;&nbsp;&nbsp; otherwise if (the current hyperlink ID - column-break) is a link ID listed in the Table of Glulx Hyperlink Replacement Commands:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; let selection be easement entry;<br>&nbsp;&nbsp;&nbsp;&nbsp; if the current hyperlink ID &lt; (column-break + 1):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the easing of the movement track is the selection;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the selected easing is current hyperlink ID;<br>&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the secondary easing of the movement track is the selection;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the selected secondary easing is current hyperlink ID;<br>&nbsp;&nbsp;&nbsp;&nbsp; follow the hyperlink listing rule;<br>&nbsp;&nbsp;&nbsp;&nbsp; say run paragraph on;<br>&nbsp;&nbsp;&nbsp;&nbsp; rule succeeds.</font></blockquote>
<p>
<blockquote><font color="#000080"> First clicking graphlink rule:<br>&nbsp;&nbsp;&nbsp;&nbsp; let graph-x be current graphlink x plus 0.0;<br>&nbsp;&nbsp;&nbsp;&nbsp; let graph-y be current graphlink y plus 0.0;<br>&nbsp;&nbsp;&nbsp;&nbsp; now entry 1 of the motion target is ((graph-x real minus the x-offset of the current graphlink window) real divided by the scaling factor of the current graphlink window) to the nearest whole number;<br>&nbsp;&nbsp;&nbsp;&nbsp; now entry 2 of the motion target is ((graph-y real minus the y-offset of the current graphlink window) real divided by the scaling factor of the current graphlink window) to the nearest whole number;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the movement track as a motion animation targeting the Ball and ending at the motion target at frame-rate fps with velocity of ball-speed;<br>&nbsp;&nbsp;&nbsp;&nbsp; rule succeeds.</font></blockquote>
<p>
 Example: ** Scourge of the Vampyr - This example combines a number of different animation presets to create walking (reel + motion) and torchlight (flicker + fade) animations. Fade and zooming effects are also employed to animate the player character's entrance into and exit from the crypt. The example also exploits Glimmr's ability to move the framing of the window on the canvas to keep the player's avatar at the center of the window, so that the rest of the room seems to move around little Peln.
<p>
<blockquote><font color="#000080"><img border=0 src=../../doc_images/paste.png> &quot;Scourge of the Vampyr&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Include Glimmr Canvas Animation by Erik Temple.<br> Include Glimmr Animation Fader - Black by Erik Temple.</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Figure Definitions</font></blockquote>
<p>
<blockquote><font color="#000080"> Figure of Annex is the file &quot;Annex.png&quot;.<br> Figure of Chamber is the file &quot;Chamber.png&quot;.<br> Figure of Cross is the file &quot;Cross.png&quot;.<br> Figure of Entry is the file &quot;Entry.png&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Figure of Entrance Mask is the file &quot;EntranceMask.png&quot;.<br> Figure of Opacity Mask is the file &quot;OpacityMask.png&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Figure of StandE00 is the file &quot;StandE00.png&quot;.<br> Figure of StandN00 is the file &quot;StandN00.png&quot;.<br> Figure of StandS00 is the file &quot;StandS00.png&quot;.<br> Figure of StandW00 is the file &quot;StandW00.png&quot;.<br> Figure of WalkE01 is the file &quot;WalkE01.png&quot;.<br> Figure of WalkE02 is the file &quot;WalkE02.png&quot;.<br> Figure of WalkE03 is the file &quot;WalkE03.png&quot;.<br> Figure of WalkE04 is the file &quot;WalkE04.png&quot;.<br> Figure of WalkN01 is the file &quot;WalkN01.png&quot;.<br> Figure of WalkN02 is the file &quot;WalkN02.png&quot;.<br> Figure of WalkN03 is the file &quot;WalkN03.png&quot;.<br> Figure of WalkN04 is the file &quot;WalkN04.png&quot;.<br> Figure of WalkS01 is the file &quot;WalkS01.png&quot;.<br> Figure of WalkS02 is the file &quot;WalkS02.png&quot;.<br> Figure of WalkS03 is the file &quot;WalkS03.png&quot;.<br> Figure of WalkS04 is the file &quot;WalkS04.png&quot;.<br> Figure of WalkW01 is the file &quot;WalkW01.png&quot;.<br> Figure of WalkW02 is the file &quot;WalkW02.png&quot;.<br> Figure of WalkW03 is the file &quot;WalkW03.png&quot;.<br> Figure of WalkW04 is the file &quot;WalkW04.png&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Window initializations</font></blockquote>
<p>
<blockquote><font color="#000080"> The divider is a g-window spawned by the main-window. The type is g-graphics. The position is g-placeright. The measurement is 360. The back-colour is g-lavender.</font></blockquote>
<p>
<blockquote><font color="#000080"> The side-window is a text-buffer g-window spawned by the divider. The position of the side-window is g-placebelow. The measurement is 99. The back-colour is g-lavender.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-window is a graphics g-window spawned by the divider. The position of the graphics-window is g-placeabove. The measurement of the graphics-window is 260. The back-colour of the graphics-window is g-black. The arbitrary scaling factor of the graphics-window is 1.0000.</font></blockquote>
<p>
<blockquote><font color="#000080"> The graphics-canvas is a g-canvas. The canvas-width is 752. The canvas-height is 352. The associated canvas of the graphics-window is the graphics-canvas. The associated canvas of a g-element is the graphics-canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> Window-drawing rule for the side-window (this is the construct inventory rule):<br> move focus to side-window, clearing the window;<br> try taking inventory;<br> return to main screen.</font></blockquote>
<p>
<blockquote><font color="#000080"> Every turn when the side-window is g-present: follow the window-drawing rules for the side-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; open up the graphics-window;<br>&nbsp;&nbsp;&nbsp;&nbsp; open up the side-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Room sprites</font></blockquote>
<p>
<blockquote><font color="#000080"> A room-sprite is a kind of sprite. The graphlink status of a room-sprite is g-inactive. The associated canvas of a room-sprite is graphics-canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> Some room-sprites are defined by the Table of Room-sprite Elements.</font></blockquote>
<p>
<blockquote><font color="#000080"> Table of Room-Sprite Elements</font><br><table border="0" cellspacing="0" cellpadding="0"><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> room-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> origin</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> image-ID</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> display-layer</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Entry-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 0, 0 }</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Entry</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 1</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Cross-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 95, 48 }</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Cross</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 1</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Annex-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 302, 80 }</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Annex</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 1</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Chamber-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 493, 176 }</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Chamber</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 1</font></font></td></tr></table></blockquote>
<p>
<blockquote><font color="#000080"> Section - Icon-sprites</font></blockquote>
<p>
<blockquote><font color="#000080"> An icon-sprite is a kind of sprite. The graphlink status of an icon-sprite is g-inactive. The associated canvas of an icon-sprite is graphics-canvas.</font></blockquote>
<p>
<blockquote><font color="#000080"> Some icon-sprites are defined by the Table of Icon-sprite Elements.</font></blockquote>
<p>
<blockquote><font color="#000080"> Table of Icon-Sprite Elements</font><br><table border="0" cellspacing="0" cellpadding="0"><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> icon-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> origin</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> image-ID</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> display-layer</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> scaling factor</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Player-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 26, -17 }</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of StandS00</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 2</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 0.7500</font></font></td></tr></table></blockquote>
<p>
<blockquote><font color="#000080"> Table of Player Icon Positioning</font><br><table border="0" cellspacing="0" cellpadding="0"><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> room</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> coordinate</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Crypt Annex</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 26, 97 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Cross-Shaped Chamber</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 200, 97 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Dim Corner</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 311, 97 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Dark Corner</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 311, 226 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Untidy Vault</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 382, 226 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Burial Hall</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 591, 242 }</font></font></td></tr></table></blockquote>
<p>
<blockquote><font color="#000080"> Section - Mask sprites</font></blockquote>
<p>
<blockquote><font color="#000080"> A mask-sprite is a kind of sprite. Some mask-sprites are defined by the Table of Mask Sprites.</font></blockquote>
<p>
<blockquote><font color="#000080"> Table of Mask Sprites</font><br><table border="0" cellspacing="0" cellpadding="0"><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> mask-sprite</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> image-ID</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> display-layer</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> origin</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> entrance mask</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Entrance Mask</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 3</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 17, -17 }</font></td></tr><tr><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> opacity mask</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> Figure of Opacity Mask</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> 4</font>&nbsp;&nbsp;&nbsp;&nbsp;</font></td><td align="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><font color="#000080"> { 493, 176 }</font></font></td></tr></table></blockquote>
<p>
<blockquote><font color="#000080"> Section - Manual canvas framing</font></blockquote>
<p>
<blockquote><font color="#000080"> To decide what list of numbers is (coord - a list of numbers) offset to the origin of (win - a graphics g-window):<br>&nbsp;&nbsp;&nbsp;&nbsp; let L be a list of numbers;<br>&nbsp;&nbsp;&nbsp;&nbsp; let x be entry 1 of coord;<br>&nbsp;&nbsp;&nbsp;&nbsp; let y be entry 2 of coord;<br>&nbsp;&nbsp;&nbsp;&nbsp; add (x - (canvas-width of the associated canvas of win / 2)) to L;<br>&nbsp;&nbsp;&nbsp;&nbsp; add (y - (canvas-height of the associated canvas of win / 2)) to L;<br>&nbsp;&nbsp;&nbsp;&nbsp; decide on L.</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Walking animations</font></blockquote>
<p>
<blockquote><font color="#000080"> The walking track is animation track. The image-reel is { Figure of WalkS01, Figure of WalkS02, Figure of WalkS03, Figure of WalkS04 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> The movement track is an animation track. The animation-callback of the movement track is &quot;[@ deactivate the walking track][@ now the image-ID of the player-sprite is the facing of the direction gone]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> A direction has a list of figure names called the direction-reel.</font></blockquote>
<p>
<blockquote><font color="#000080"> The direction-reel of north is { Figure of WalkN01, Figure of WalkN02, Figure of WalkN03, Figure of WalkN04 }.<br> The direction-reel of south is { Figure of WalkS01, Figure of WalkS02, Figure of WalkS03, Figure of WalkS04 }.<br> The direction-reel of east is { Figure of WalkE01, Figure of WalkE02, Figure of WalkE03, Figure of WalkE04 }.<br> The direction-reel of west is { Figure of WalkW01, Figure of WalkW02, Figure of WalkW03, Figure of WalkW04 }.</font></blockquote>
<p>
<blockquote><font color="#000080"> A direction has a figure name called the facing.</font></blockquote>
<p>
<blockquote><font color="#000080"> The direction gone is a direction variable.<br> The destination room is a room variable.</font></blockquote>
<p>
<blockquote><font color="#000080"> The facing of north is Figure of StandN00.<br> The facing of south is Figure of StandS00.<br> The facing of east is Figure of StandE00.<br> The facing of west is Figure of StandW00.</font></blockquote>
<p>
<blockquote><font color="#000080"> Before window-framing adjustment of the graphics-window:<br>&nbsp;&nbsp;&nbsp;&nbsp; if entrance complete is false:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; center the frame of the graphics-window on canvas coordinates { 26, 97 };<br>&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; center the frame of the graphics-window on canvas coordinates (origin of the player-sprite);<br>&nbsp;&nbsp;&nbsp;&nbsp; continue the action.</font></blockquote>
<p>
<blockquote><font color="#000080"> After going (this is the basic walking animation rule):<br>&nbsp;&nbsp;&nbsp;&nbsp; unless the room gone from is the Burial Hall or the room gone to is the Burial Hall:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the direction gone is the noun;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the image-reel of the walking track is the direction-reel of the direction gone;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set up the movement animation for walking to the room gone to;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; animate the walking track as a reel animation targeting the player-sprite at 8 fps, cycling;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay input until all animations are complete;<br>&nbsp;&nbsp;&nbsp;&nbsp; continue the action.</font></blockquote>
<p>
<blockquote><font color="#000080"> To set up the movement animation for walking to (R - a room):<br>&nbsp;&nbsp;&nbsp;&nbsp; let L be a list of numbers;<br>&nbsp;&nbsp;&nbsp;&nbsp; let L be the coordinate corresponding to a room of R in the Table of Player Icon Positioning;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the movement track as a motion animation targeting the player-sprite and ending at L at 8 fps with velocity of 10.</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Walking via a waypoint</font></blockquote>
<p>
<blockquote><font color="#000080"> The waypoint movement track is an animation track. The animation-callback of the waypoint movement track is &quot;[@ set up the movement animation for walking to the destination room]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> After going when the room gone from is the Burial Hall or the room gone to is the Burial Hall:<br>&nbsp;&nbsp;&nbsp;&nbsp; now the direction gone is the noun;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the destination room is the room gone to;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the image-reel of the walking track is the direction-reel of the direction gone;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the walking track as a reel animation targeting the player-sprite at 8 fps, cycling;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the waypoint movement track as a motion animation targeting the player-sprite and ending at { 421, 242 } at 8 fps with velocity of 10;<br>&nbsp;&nbsp;&nbsp;&nbsp; delay input until all animations are complete;<br>&nbsp;&nbsp;&nbsp;&nbsp; ignore the basic walking animation rule;<br>&nbsp;&nbsp;&nbsp;&nbsp; continue the action.</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Entrance animation</font></blockquote>
<p>
<blockquote><font color="#000080"> The dungeon entrance track is an animation track. The animation-callback is &quot;[@ deactivate the walking track][@ now the image-ID of the player-sprite is Figure of StandS00][@ now entrance complete is true]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Entrance complete is a truth state variable.</font></blockquote>
<p>
<blockquote><font color="#000080"> When play begins:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You are Peln, vampire hunter manqu.[paragraph break]You stand at the entrance to a foul fiend's crypt. Fingering your sharpened stake, you admire its pointy shadow it casts in the morning sun. Today is the day you take up the mantle you were destined to wear-Scourge of the Vampyr![paragraph break]Press any key to descend into the crypt.&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; wait for any key in the main-window;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You step down into the cool damp of the staircase...&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the default track as a zooming animation targeting the player-sprite and ending at 1.0000 at 8 fps with duration 4 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the walking track as a reel animation targeting the player-sprite at 8 fps, cycling;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the dungeon entrance track as a motion animation targeting the player-sprite and ending at { 26, 97 } at 8 fps with velocity 10;<br>&nbsp;&nbsp;&nbsp;&nbsp; delay input until all animations are complete;<br>&nbsp;&nbsp;&nbsp;&nbsp; clear the main-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Lighting</font></blockquote>
<p>
<blockquote><font color="#000080"> The lighting track is an animation track. The easing is the circular easing out rule. The animation-callback is &quot;[@ activate the Chamber-sprite]&quot;.</font></blockquote>
<p>
<blockquote><font color="#000080"> Understand the command &quot;light&quot; as something new. Understand &quot;light [something]&quot; as switching on.</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of switching on the lamp in the Burial Hall:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You ease the wick out of the base. As the flame flickers to life, the details of the room emerge.&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; deactivate the opacity mask;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the default track as a flicker animation targeting the Chamber-sprite at 18 fps with a duration of 20 frames, randomized;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the lighting track as a fade animation targeting the Chamber-sprite and using the black-fader from 80 % to 0 % at 18 fps with a duration of 20 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp; delay input until all animations are complete;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the lamp is lit.</font></blockquote>
<p>
<blockquote><font color="#000080"> Understand &quot;extinguish [something]&quot; as switching off.</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of switching off the lamp in the Burial Hall:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You turn down the flame. &quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; animate the lighting track as a fade animation targeting the Chamber-sprite and using the black-fader from 0 % to 75 % at 18 fps with a duration of 8 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp; delay input until all animations are complete;<br>&nbsp;&nbsp;&nbsp;&nbsp; activate the opacity mask;<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;The lamp is extinguished.&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; now the lamp is unlit;<br>&nbsp;&nbsp;&nbsp;&nbsp; follow the window-drawing rules for the graphics-window.</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of switching on the lamp:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You can see well enough thanks to the vents near the ceiling. Better save the oil until you need it.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - World</font></blockquote>
<p>
<blockquote><font color="#000080"> The player carries a stake and a lamp. The lamp is a device. The lamp can be lit or unlit. The lamp is unlit.</font></blockquote>
<p>
<blockquote><font color="#000080"> Crypt Annex is a room. &quot;The stairs open onto a narrow rectangular hall of vaulted stone. There's no need to fire up the lamp, at least not yet: rectangular sidelights at ground level let in just enough of the day to see by.[paragraph break]At the south end of the room, a hallway leads east.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of going north in the Annex:<br>&nbsp;&nbsp;&nbsp;&nbsp; if we have examined the sarcophagus:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the image-reel of the walking track is the direction-reel of north;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the animation-callback of the dungeon entrance track is &quot;[@ deactivate the walking track]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; animate the default track as a fade animation targeting the graphics-window and using the black-fader from 0 % to 100 % at 8 fps with a duration of 20 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; animate the walking track as a reel animation targeting the player-sprite at 8 fps, cycling;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; animate the dungeon entrance track as a motion animation targeting the player-sprite and ending at { 26, -17 } at 8 fps with a duration of 20 frames;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; now the animation-callback of the default track is &quot;[@ now the associated canvas of the graphics-window is the g-null-canvas]&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delay input until all animations are complete;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end the story saying &quot;You have failed to slay the vampire!&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; otherwise:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; say &quot;You're not leaving until you've impaled the fiend.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of going up in the Annex:<br>&nbsp;&nbsp;&nbsp;&nbsp; try going north.</font></blockquote>
<p>
<blockquote><font color="#000080"> Cross-Shaped Chamber is east of Annex. &quot;You step into a small chamber built in the shape of an Andean cross. Come to think of it, you wish you'd remembered your silver crucifix...[paragraph break]The hall continues to the east.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Dim Corner is east of Cross-Shaped Chamber. &quot;The hallway turns south here.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Dark Corner is south of Dim Corner. &quot;The hallway turns again, back to the east, and opens just ahead into a wider space. The sidelights above continue to cast a dim light.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Untidy Vault is east of Dark Corner. &quot;This is a rather untidy vaulted chamber. You can climb over the rubble to enter the hole that's been punched through the wall to the east.&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Burial Hall is east of Untidy Vault. &quot;The lamp reveals a large chamber. Pillars flank a wide central aisle and disappear into the gloom above. There are no other exits except for the hole to the west by which you entered.[if we have not examined the sarcophagus][paragraph break]Hm, the lack of light from outside would make this a perfect hideaway for the villainous vamp![end if]&quot;. The hall is dark.</font></blockquote>
<p>
<blockquote><font color="#000080"> After looking in the Hall when we have examined the sarcophagus:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;There is nothing to do but to return to the surface. You will slay no undead today.&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp; continue the action.</font></blockquote>
<p>
<blockquote><font color="#000080"> The sarcophagus is a container in the hall. &quot;A large stone sarcophagus lies open in a niche at the east end of the chamber.&quot; The sarcophagus is fixed in place.</font></blockquote>
<p>
<blockquote><font color="#000080"> The description of the sarcophagus is &quot;The sarcophagus is empty. The fiend is not here! Even the earth from his home burial ground has been removed.[paragraph break]He has moved on. You are too late, Peln!&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Instead of searching the sarcophagus:<br>&nbsp;&nbsp;&nbsp;&nbsp; try examining the sarcophagus.</font></blockquote>
<p>
<blockquote><font color="#000080"> The description of the player is &quot;[if we have not examined the sarcophagus]You are fearsome and optimistic[otherwise]Peln is sad[end if].&quot;</font></blockquote>
<p>
<blockquote><font color="#000080"> Section - Image credit</font></blockquote>
<p>
<blockquote><font color="#000080"> Report requesting the story file version:<br>&nbsp;&nbsp;&nbsp;&nbsp; say &quot;The images used in this demo come courtesy of:[paragraph break] - Sean Howard, via his Free Pixel Project (http://www.squidi.net/pixel/index.php), released under the Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License.[line break] - David E. Gervais (http://pousse.rapiere.free.fr/tome/), released under Creative Commons Attribution 3.0 Unported License.&quot;</font></blockquote>
<p>

<p>
<p></body></html>